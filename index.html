<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Siber Macera</title>
    
    <!-- Safari i√ßin PWA ve kiosk mode desteƒüi -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Siber Macera">
    
    <!-- Safari i√ßin tam ekran desteƒüi -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a1428">
    <meta name="msapplication-navbutton-color" content="#0a1428">
    <meta name="format-detection" content="telephone=no">
    <!-- Font preload for faster loading -->
    <link rel="preload" href="fonts/Gilmer Regular.otf" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="fonts/Gilmer Light.otf" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="fonts/Gilmer Bold.otf" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="fonts/conthrax-sb.otf" as="font" type="font/otf" crossorigin>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js" defer></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js" defer></script>
  </head>
  <body>
      <!-- Y√ºkleme Ekranƒ± -->
      <div id="loading-screen" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, #0a1428 0%, #1a2844 50%, #2a3c66 100%); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999;">
          <img src="assets/oyungirisekranƒ±.svg" alt="Oyun Giri≈ü Ekranƒ±" style="max-width: 80%; max-height: 40%; margin-bottom: 30px;" loading="eager">
          <div style="color: #ffaa00; font-family: 'Gilmer Light', Arial, sans-serif; font-size: 1.2rem; margin-bottom: 30px; text-align: center;">
              Oyun y√ºkleniyor...
          </div>
          <div style="width: 200px; height: 6px; background: rgba(255,255,255,0.2); border-radius: 3px; overflow: hidden;">
              <div style="width: 100%; height: 100%; background: linear-gradient(90deg, #00ff99, #0066cc); border-radius: 3px; animation: loading 2s ease-in-out infinite;"></div>
          </div>
      </div>
      
      <div class="background">
          <img src="assets/Asset 4.svg" alt="Arka Plan" class="background-img" loading="lazy">
          <img src="assets/Asset 5.svg" alt="Siber G√ºvenlik Ba≈ükanlƒ±ƒüƒ±" class="logo" loading="lazy">
          
          <!-- Ana Ekrana D√∂n Butonu - Saƒü √úst K√∂≈üe -->
          <div id="home-button" class="home-button" style="display: none;">
              <img src="assets/anaekranadon.svg" alt="Ana Ekrana D√∂n" loading="lazy" 
                   onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;80&quot; height=&quot;40&quot; viewBox=&quot;0 0 80 40&quot;><rect width=&quot;80&quot; height=&quot;40&quot; fill=&quot;%23ff6600&quot; rx=&quot;5&quot;/><text x=&quot;40&quot; y=&quot;25&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-family=&quot;Arial&quot; font-size=&quot;12&quot;>Ana Ekran</text></svg>';">
          </div>
        <!-- Ya≈ü Grubu Se√ßimi Paneli -->
        <div class="center-panel" id="age-selection-panel" style="display: none;">
            <div class="main-title-panel">
                <img src="assets/Asset 13.svg" alt="Siber Macera" class="main-title-svg" loading="lazy">
                <div class="inside-panel">
                    <div class="panel-desc">Ya≈ü grubunuzu se√ßin</div>
                    <div class="age-selection-container" style="display: flex; flex-direction: column; gap: 20px; margin-top: 30px; align-items: center;">
                        <div class="age-button" id="child-mode-btn" style="position: relative; cursor: pointer; transition: all 0.3s ease;" onclick="selectAgeGroup('child')">
                            <img src="assets/Asset 31.svg" style="width: 350px; height: auto;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: 'Gilmer Bold', sans-serif; font-size: 1.2rem; text-align: center; white-space: nowrap; z-index: 10;">√áOCUK (8-14 ya≈ü)</div>
                        </div>
                        <div class="age-button" id="adult-mode-btn" style="position: relative; cursor: pointer; transition: all 0.3s ease;" onclick="selectAgeGroup('adult')">
                            <img src="assets/Asset 31.svg" style="width: 350px; height: auto;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: 'Gilmer Bold', sans-serif; font-size: 1.2rem; text-align: center; white-space: nowrap; z-index: 10;">YETƒ∞≈ûKƒ∞N (15+ ya≈ü)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ana Panel -->
        <div class="center-panel" id="main-panel" style="display:none;">
            <div class="main-title-panel">
                <img src="assets/Asset 13.svg" alt="Siber Macera" class="main-title-svg" loading="lazy">
                <div class="inside-panel">
                    <div class="panel-desc" id="main-panel-desc">Siber sƒ±rlarƒ± √ß√∂z, oyunu kazan, g√ºvende kal!</div>
                    <div class="main-buttons">
                        <img src="assets/Asset 9.svg" alt="Parola G√ºc√º" class="main-btn-svg" loading="lazy">
                        <img src="assets/Asset 10.svg" alt="Payla≈ü/Sakla" class="main-btn-svg" loading="lazy">
                        <img src="assets/Asset 11.svg" alt="Oltalama Testi" class="main-btn-svg" loading="lazy">
                        <img src="assets/Asset 12.svg" alt="Hemen Ba≈üla" class="main-btn-svg start-svg" id="start-btn" loading="lazy">
                    </div>
                </div>
            </div>
        </div>
        <!-- Kullanƒ±cƒ± Adƒ± Paneli -->
        <div class="center-panel" id="username-panel" style="display:none;">
            <div class="main-title-panel">
                <img src="assets/Asset 13.svg" alt="Siber Macera" class="main-title-svg" loading="lazy">
                <div class="inside-panel">
                    <div class="panel-desc">Macaraya ba≈ülamak i√ßin<br>kod adƒ±nƒ±zƒ± giriniz.</div>
                    <div class="input-svg-wrapper">
                        <img src="assets/Asset 14.svg" alt="Input Alanƒ±" class="input-svg" loading="lazy">
                        <input type="text" class="username-input-on-svg" placeholder="Kod adƒ±nƒ±z..." id="username-input">
                    </div>
                    <img src="assets/Asset 15.svg" alt="Oyuna Ba≈üla" class="main-btn-svg start-svg" id="play-btn" loading="lazy">
                </div>
            </div>
        </div>
        <!-- Parola G√ºc√º Paneli -->
        <div class="center-panel" id="password-panel" style="display:none;">
            <div class="password-panel-outer">
                <img src="assets/Asset 27.svg" alt="Panel √áer√ßeve" class="password-panel-bg" loading="lazy">
                <!-- √úst Bilgiler -->
                <div class="password-panel-top">
                  <div class="svg-box">
                    <img src="assets/Asset 28.svg" class="svg-bg" loading="lazy">
                    <div class="svg-text" id="timer">S√ºre: 00:00</div>
                  </div>
                  <div class="svg-box">
                    <img src="assets/Asset 29.svg" class="svg-bg" loading="lazy">
                    <div class="svg-text">Puan: <span id="score">0</span></div>
                  </div>
                </div>
                <!-- Ba≈ülƒ±k ve A√ßƒ±klama -->
                <div class="password-panel-content">
                    <img src="assets/Asset 34.svg" alt="G√ºvenlik ƒ∞konu" class="security-icon" loading="lazy">
                    <div class="password-title">PAROLA G√úC√ú</div>
                    <div class="password-desc" id="password-desc">Parolanƒ±zƒ± girin ve g√ºc√ºn√º test edin.</div>
                    <div class="input-svg-wrapper password-input-wrapper" id="password-input-wrapper">
                        <img src="assets/Asset 32.svg" alt="Parola Input" class="input-svg" loading="lazy">
                        <input type="password" class="username-input-on-svg password-input" placeholder="Parolanƒ±z..." id="password-input-1" maxlength="12">
                    </div>
                    <div class="input-svg-wrapper password-input-wrapper" id="password-confirm-wrapper" style="margin-top: 12px;">
                        <img src="assets/Asset 32.svg" alt="Parola Onay Input" class="input-svg" loading="lazy">
                        <input type="password" class="username-input-on-svg password-input" placeholder="Parolayƒ± tekrar girin..." id="password-input-2" maxlength="12">
                    </div>
                    <div id="password-match-message" style="text-align: center; margin: 8px 0; font-size: 0.9rem; color: #ff4444;"></div>
                    <div class="password-check-btn-wrapper" id="password-check-btn-wrapper">
                        <img src="assets/Asset 33.svg" alt="Kontrol Et" class="password-check-btn" id="check-password-btn" style="opacity: 0.5; pointer-events: none;" loading="lazy">
                    </div>
                    <div class="password-result" id="password-result" style="display:none;">
                        <div id="strength-label"></div>
                        <div id="crack-time"></div>
                        <div id="congrats-message"></div>
                        <div id="next-task-btn" class="next-task-btn" style="display:none;">
                            <img src="assets/Asset 35.svg" alt="Payla≈ü/Sakla G√∂revine Ge√ß" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- PAYLA≈û/SAKLA Paneli -->
        <div class="center-panel" id="share-panel" style="display:none;">
            <div class="password-panel-outer">
                <img src="assets/Asset 27.svg" alt="Panel √áer√ßeve" class="password-panel-bg">
                <div class="password-panel-top">
                  <div class="svg-box">
                    <img src="assets/Asset 28.svg" class="svg-bg">
                    <div class="svg-text" id="timer-share">S√ºre: 00:00</div>
                  </div>
                  <div class="svg-box">
                    <img src="assets/Asset 29.svg" class="svg-bg">
                    <div class="svg-text">Puan: <span id="score-share">0</span></div>
                  </div>
                </div>
                <div class="password-panel-content">
                    <img src="assets/Asset 36.svg" alt="Payla≈ü Sakla ƒ∞kon" class="security-icon">
                    <div class="password-title">PAYLA≈û/SAKLA</div>
                    <div class="password-desc">A≈üaƒüƒ±daki bilgilerden hangilerini g√ºvenle payla≈üabileceƒüini se√ß:</div>
                    
                    <div id="share-questions-container" class="share-questions-container">
                        <!-- Sorular buraya dinamik olarak eklenecek -->
                    </div>
                    
                    <div id="continue-to-phishing-btn" class="continue-btn" style="display:block !important; text-align: center; margin-top: 30px; width: 100%; padding: 20px; position: relative; z-index: 100; visibility: visible !important; opacity: 1 !important;" onclick="checkShareAnswers()">
                        <img src="assets/oltalamatestinegec.svg" alt="Oltalama Testine Ge√ß" style="max-width: 350px; width: 100%; cursor: pointer; transition: transform 0.2s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;350&quot; height=&quot;60&quot; viewBox=&quot;0 0 350 60&quot;><rect width=&quot;350&quot; height=&quot;60&quot; fill=&quot;%23ff3366&quot; rx=&quot;10&quot;/><text x=&quot;175&quot; y=&quot;38&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-family=&quot;Arial&quot; font-size=&quot;16&quot; font-weight=&quot;bold&quot;>OLTALAMA TESTƒ∞NE GE√á</text></svg>';">
                    </div>
                    
                    <div id="share-results" class="share-results" style="display:none;">
                        <!-- Sonu√ßlar burada g√∂sterilecek -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- PHISHING TEST Paneli -->
        <div class="center-panel" id="phishing-panel" style="display:none;">
            <div class="password-panel-outer">
                <img src="assets/Asset 27.svg" alt="Panel √áer√ßeve" class="password-panel-bg">
                <div class="password-panel-top">
                  <div class="svg-box">
                    <img src="assets/Asset 28.svg" class="svg-bg">
                    <div class="svg-text" id="timer-phishing">S√ºre: 00:00</div>
                  </div>
                  <div class="svg-box">
                    <img src="assets/Asset 29.svg" class="svg-bg">
                    <div class="svg-text">Puan: <span id="score-phishing">0</span></div>
                  </div>
                </div>
                <div class="password-panel-content">
                    <img src="assets/Asset 30.svg" alt="Phishing Test ƒ∞kon" class="security-icon">
                    <div class="password-title">OLTALAMA TESTƒ∞</div>
                    <div class="password-desc" id="phishing-desc">Instagram ≈üifrenizi g√ºncellemeniz gerekiyor. Buraya tƒ±klayƒ±n.<br>Link adresi: insta-security.verify-update.ru</div>
                                         <div class="phishing-buttons-container" style="display: flex; flex-direction: column; gap: 12px; margin-top: 50px; width: 100%; max-width: 600px;">
                                                 <div class="phishing-button" data-answer="wrong" style="position: relative; cursor: pointer; transition: all 0.3s ease;">
                             <img src="assets/Asset 31.svg" style="width: 100%; height: auto; min-height: 60px;">
                             <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: 'Gilmer Light', sans-serif; font-size: 1rem; text-align: center; width: 90%; line-height: 1.2;">Link ger√ßek gibi, tƒ±klarƒ±m.</div>
                         </div>
                         <div class="phishing-button" data-answer="correct" style="position: relative; cursor: pointer; transition: all 0.3s ease;">
                             <img src="assets/Asset 31.svg" style="width: 100%; height: auto; min-height: 60px;">
                             <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: 'Gilmer Light', sans-serif; font-size: 1rem; text-align: center; width: 90%; line-height: 1.2;">Adres tuhaf, dikkatli olurum.</div>
                         </div>
                         <div class="phishing-button" data-answer="wrong" style="position: relative; cursor: pointer; transition: all 0.3s ease;">
                             <img src="assets/Asset 31.svg" style="width: 100%; height: auto; min-height: 60px;">
                             <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: 'Gilmer Light', sans-serif; font-size: 1rem; text-align: center; width: 90%; line-height: 1.2;">≈ûifreyi yazar ge√ßerim.</div>
                         </div>
                    </div>
                    <div id="phishing-explanation" class="share-explanation"></div>
                </div>
            </div>
        </div>
        
        <!-- FINAL SKOR Paneli -->
        <div class="final-score-wrapper" id="final-score-panel" style="display:none;">
            <div class="final-score-container">
                <img src="assets/Asset 21.svg" alt="Skor Panel √áer√ßeve" class="final-score-bg">
                <div class="final-score-content">
                    <img src="assets/Asset 23.svg" alt="Yƒ±ldƒ±z ƒ∞kon" class="final-score-star">
                    <div class="final-score-title">Tebrikler! Siber G√ºvenlik Macerasƒ±nƒ± Tamamladƒ±n.</div>

                    <div class="final-score-row">
                        <span>Kullanƒ±cƒ± Adƒ±</span><span id="final-username">ƒ∞sim</span>
                    </div>
                    <div class="final-score-row">
                        <span>Parola G√ºc√º √ñl√ßme</span><span id="final-password-score">30 Puan</span>
                    </div>
                    <div class="final-score-row">
                        <span>Payla≈ü/Sakla G√∂revi</span><span id="final-share-score">190 Puan</span>
                    </div>
                    <div class="final-score-row">
                        <span>Oltalama Testi</span><span id="final-phishing-score">0 Puan</span>
                    </div>
                    <div class="final-score-row bold">
                        <span>Toplam S√ºre</span><span id="final-total-time">00:34</span>
                    </div>
                    <div class="final-score-row bold total">
                        <span>Toplam Puan</span><span id="final-total-score">220</span>
                    </div>

                    <div class="final-back-btn" id="final-back-btn">
                        <img src="assets/Asset 22.svg" alt="Ana Ekrana D√∂n"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;120&quot; height=&quot;50&quot; viewBox=&quot;0 0 120 50&quot;><rect width=&quot;120&quot; height=&quot;50&quot; fill=&quot;%23ff6600&quot; rx=&quot;8&quot;/><text x=&quot;60&quot; y=&quot;32&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-family=&quot;Arial&quot; font-size=&quot;14&quot;>Ana Ekrana D√∂n</text></svg>';">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- SKOR TABLOSU Paneli -->
        <div class="center-panel" id="scoreboard-panel" style="display:none;">
            <div class="password-panel-outer" style="width: 1200px; height: 850px; max-width: 98vw; max-height: 98vh;">
                <img src="assets/Asset 27.svg" alt="Panel √áer√ßeve" class="password-panel-bg">
                <div class="password-panel-content" style="align-items:center; padding: 40px; top: 120px;">
                    <img src="assets/Asset 6.svg" alt="Skor Tablosu ƒ∞konu" class="security-icon" style="width: 70px; height: 70px;">
                    <div class="password-title" style="font-size: 1.5rem;">Sƒ∞BER G√úVENLƒ∞K SKOR TABLOSU</div>
                    <div class="password-desc" style="margin-bottom: 20px; font-size: 1.3rem;">En iyi siber kahramanlarƒ± ke≈üfedin!</div>
                    
                    <div class="scoreboard-table" style="width: 100%; max-width: 900px; margin: 20px auto;">
                        <div class="scoreboard-header" style="display: flex; background-color: rgba(108, 43, 207, 0.3); padding: 8px 12px; border-radius: 4px; margin-bottom: 3px; font-weight: bold; font-size: 0.9rem; line-height: 1.2;">
                            <span style="flex: 0 0 70px; color: #ffaa00;">Sƒ±ra</span>
                            <span style="flex: 1; color: #ffffff;">Kullanƒ±cƒ± Adƒ±</span>
                            <span style="flex: 0 0 140px; color: #ffffff; text-align: center;">Toplam Puan</span>
                            <span style="flex: 0 0 100px; color: #ffffff; text-align: center;">S√ºre</span>
                            <span style="flex: 0 0 140px; color: #ffffff; text-align: center;">Tarih</span>
                        </div>
                        <div id="scoreboard-list">
                            <!-- Skor listesi burada dinamik olarak olu≈üturulacak -->
                        </div>
                    </div>
                    
                    <!-- Sayfalama Kontrolleri -->
                    <div class="pagination-controls" style="display: flex; justify-content: center; align-items: center; gap: 15px; margin: 20px 0;">
                        <button id="prev-page-btn" style="background: #ff6600; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 14px;" disabled>‚óÄ √ñnceki</button>
                        <span id="page-info" style="color: #ffffff; font-size: 14px; min-width: 100px; text-align: center;">Sayfa 1 / 1</span>
                        <button id="next-page-btn" style="background: #ff6600; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 14px;" disabled>Sonraki ‚ñ∂</button>
                    </div>
                    
                    <div class="scoreboard-buttons" style="display: flex; gap: 25px; margin-top: 30px;">
                        <img src="assets/Asset 26.svg" alt="Yenile" id="refresh-scoreboard-btn" style="cursor: pointer; max-width: 170px; transition: transform 0.2s ease;"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;120&quot; height=&quot;40&quot; viewBox=&quot;0 0 120 40&quot;><rect width=&quot;120&quot; height=&quot;40&quot; fill=&quot;%2300cc99&quot; rx=&quot;5&quot;/><text x=&quot;60&quot; y=&quot;25&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-family=&quot;Arial&quot; font-size=&quot;12&quot;>Yenile</text></svg>';">
                        <img src="assets/anaekranadon.svg" alt="Ana Men√º" id="scoreboard-back-btn" style="cursor: pointer; max-width: 170px; transition: transform 0.2s ease;"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;120&quot; height=&quot;40&quot; viewBox=&quot;0 0 120 40&quot;><rect width=&quot;120&quot; height=&quot;40&quot; fill=&quot;%23ff6600&quot; rx=&quot;5&quot;/><text x=&quot;60&quot; y=&quot;25&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-family=&quot;Arial&quot; font-size=&quot;12&quot;>Ana Men√º</text></svg>';">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="scoreboard">
            <img src="assets/Asset 6.svg" alt="Skor Tablosu" class="scoreboard-img" loading="lazy">
        </div>
    </div>

    <script>
    // Ya≈ü grubu deƒüi≈ükenleri
    let selectedAgeGroup = null; // 'child' veya 'adult'
    
    // Sayfa y√ºklendikten hemen sonra kontrol et
    window.addEventListener('load', function() {
        console.log("üîß Window load - ya≈ü grubu √∂n kontrol√º");
        
        // Her zaman ya≈ü se√ßim panelini g√∂ster
        setTimeout(() => {
            const agePanel = document.getElementById('age-selection-panel');
            if (agePanel.style.display !== 'block') {
                console.log("‚ö†Ô∏è Ya≈ü se√ßimi g√∂r√ºnm√ºyor, zorla g√∂ster");
                agePanel.style.display = 'block';
            }
        }, 100);
    });
    
    // Firebase Configuration - teknofest projesi
    const firebaseConfig = {
        apiKey: "AIzaSyB3ofVngr1rY6Zr2bTSE3PRFT1z104nMXo",
        authDomain: "teknofest-c7a92.firebaseapp.com",
        databaseURL: "https://teknofest-c7a92-default-rtdb.firebaseio.com",
        projectId: "teknofest-c7a92",
        storageBucket: "teknofest-c7a92.firebasestorage.app",
        messagingSenderId: "478655816162",
        appId: "1:478655816162:web:0cb7626d34935611ed59bb",
        measurementId: "G-PG8ZFFEWJP"
    };

    // Firebase'i ba≈ülat (sadece ge√ßerli config varsa)
    let database = null;
    let isFirebaseEnabled = false;
    
    // Firebase konfig√ºrasyonunu kontrol et
    if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "AIzaSyExample...") {
        // Firebase'i ba≈ülat (sadece ge√ßerli config varsa)
        setTimeout(() => {
            try {
                console.log("üöÄ Firebase ba≈ülatƒ±lƒ±yor...");
                console.log("üìù Config:", firebaseConfig);
                
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                isFirebaseEnabled = true;
                console.log("‚úÖ Firebase ba≈üarƒ±yla baƒülandƒ± - √áoklu ekran modu aktif!");
                console.log("üîó Veritabanƒ± URL:", firebaseConfig.databaseURL);
                console.log("üìä Database objesi:", database);
            
            // Mevcut status div'ini kaldƒ±r (temizlik)
            const existingStatus = document.getElementById('firebase-status');
            if (existingStatus) {
                existingStatus.remove();
            }
            
            // Baƒülantƒ± testini yap
            database.ref('.info/connected').on('value', function(snapshot) {
                if (snapshot.val() === true) {
                    console.log("üåê Firebase ger√ßek zamanlƒ± baƒülantƒ±: AKTƒ∞F");
                    showFirebaseStatus("üåê √áoklu ekran modu: AKTƒ∞F", "#00ff99");
                } else {
                    console.log("‚ö†Ô∏è Firebase baƒülantƒ±sƒ± kopuk");
                    showFirebaseStatus("‚ö†Ô∏è Baƒülantƒ± kopuk - Yerel aƒü modu", "#ffaa00");
                    // Firebase kopuksa yerel aƒüƒ± kur
                    setupLocalNetworkSync();
                }
            });
            
        } catch (error) {
            console.warn("‚ùå Firebase baƒülantƒ±sƒ± ba≈üarƒ±sƒ±z, yerel aƒü modu kullanƒ±lƒ±yor:", error);
            isFirebaseEnabled = false;
            showFirebaseStatus("üè† Yerel aƒü modu - Sadece bu aƒü", "#ffaa00");
            setupLocalNetworkSync();
        }
        }, 300); // 300ms gecikme ile Firebase'i ba≈ülat
    } else {
        console.warn("‚öôÔ∏è Firebase konfig√ºrasyonu eksik, yerel aƒü modu kullanƒ±lƒ±yor");
        console.log("üìã √áoklu ekran i√ßin FIREBASE_KURULUM.md dosyasƒ±nƒ± okuyun");
        isFirebaseEnabled = false;
        showFirebaseStatus("üè† Yerel aƒü modu aktif", "#ff4444");
        setupLocalNetworkSync();
    }
    
        // Firebase durumunu ekranda g√∂ster (gizli mod)
        function showFirebaseStatus(message, color) {
            // Firebase durumu console'da g√∂r√ºns√ºn ama ekranda g√∂r√ºnmesin
            if (message.includes("AKTƒ∞F")) {
                console.log("üü¢ " + message);
            } else if (message.includes("kopuk")) {
                console.log("üü° " + message);
            } else {
                console.log("üî¥ " + message);
            }
            
            // G√∂rsel mesaj g√∂sterme (istenirse aktif edilebilir)
            // Kullanƒ±cƒ± debug yapmak isterse bu kƒ±smƒ± a√ßabilir
        }

        // Yerel aƒü senkronizasyonu kur
        function setupLocalNetworkSync() {
            console.log("üè† Yerel aƒü senkronizasyonu ba≈ülatƒ±lƒ±yor...");
            
            if ('BroadcastChannel' in window) {
                localNetworkChannel = new BroadcastChannel('siber-macera-scores');
                
                localNetworkChannel.onmessage = (event) => {
                    const { type, data } = event.data;
                    console.log("üì° Yerel aƒü mesajƒ± alƒ±ndƒ±:", type, data);
                    
                    switch (type) {
                        case 'SCORE_UPDATE':
                            handleNetworkScoreUpdate(data);
                            break;
                        case 'REQUEST_SCORES':
                            sendLocalScores();
                            break;
                        case 'NEW_SCORE':
                            handleNewNetworkScore(data);
                            break;
                        case 'SCORES_RESPONSE':
                            console.log("üì• Skor yanƒ±tƒ± alƒ±ndƒ±:", data?.length || 0);
                            handleNetworkScoreUpdate(data);
                            break;
                        case 'CLEAR_SCORES':
                            console.log("üóëÔ∏è Skorlarƒ± temizle mesajƒ± alƒ±ndƒ±");
                            handleClearScoresFromNetwork(data);
                            break;
                        case 'DEVICE_PING':
                            console.log("üì± Cihaz ping alƒ±ndƒ±:", data.deviceId, "Skor sayƒ±sƒ±:", data.scoreCount);
                            // Ping gelen cihazdan skorlarƒ± talep et
                            if (data.scoreCount > 0) {
                                localNetworkChannel.postMessage({ type: 'REQUEST_SCORES' });
                            }
                            break;
                    }
                };
                
                // Sayfa y√ºklendiƒüinde skorlarƒ± talep et
                setTimeout(() => {
                    localNetworkChannel.postMessage({ type: 'REQUEST_SCORES' });
                    console.log("üöÄ ƒ∞lk skor talebi g√∂nderildi");
                }, 1000);
                
                // Kƒ±sa aralƒ±klarla skorlarƒ± talep et ve payla≈ü
                setInterval(() => {
                    localNetworkChannel.postMessage({
                        type: 'DEVICE_PING',
                        data: { 
                            deviceId: getDeviceId(), 
                            timestamp: Date.now(),
                            page: 'game',
                            scoreCount: getLocalScores().length
                        }
                    });
                    
                    // Skorlarƒ± da talep et
                    localNetworkChannel.postMessage({ type: 'REQUEST_SCORES' });
                }, 5000); // 5 saniyede bir
                
                console.log("‚úÖ Yerel aƒü senkronizasyonu aktif - Tabletler arasƒ± skor payla≈üƒ±mƒ± √ßalƒ±≈üƒ±yor");
                showFirebaseStatus("üè† Yerel aƒü modu - Tabletler arasƒ± senkronizasyon", "#00ff99");
            } else {
                console.warn("‚ùå BroadcastChannel desteklenmiyor");
            }
        }

        // Aƒüdan gelen skor g√ºncellemesini i≈üle
        function handleNetworkScoreUpdate(newScores) {
            if (!newScores || newScores.length === 0) return;
            
            console.log("üìä Aƒüdan skor g√ºncellemesi alƒ±ndƒ±:", newScores.length);
            
            // Mevcut yerel skorlarƒ± al
            const localScores = getLocalScores();
            
            // Yeni skorlarƒ± ekle
            const allScores = [...localScores, ...newScores];
            
            // Tekrarlarƒ± temizle (timestamp'e g√∂re)
            const uniqueScores = allScores.filter((score, index, self) => 
                index === self.findIndex(s => s.timestamp === score.timestamp)
            );
            
            // Sƒ±rala
            uniqueScores.sort((a, b) => {
                if (b.score !== a.score) {
                    return b.score - a.score;
                }
                const timeA = convertTimeToSeconds(a.time);
                const timeB = convertTimeToSeconds(b.time);
                return timeA - timeB;
            });
            
            // localStorage'a kaydet
            localStorage.setItem('cyberScores', JSON.stringify(uniqueScores));
            
            console.log("üîÑ Skorlar yerel aƒüdan g√ºncellendi:", uniqueScores.length);
        }

        // Yeni tek skor i≈üle (anƒ±nda senkronizasyon i√ßin)
        function handleNewNetworkScore(newScore) {
            if (!newScore) return;
            
            console.log("‚ö° Yeni skor anƒ±nda alƒ±ndƒ±:", newScore.username, newScore.score);
            
            const localScores = getLocalScores();
            
            // Bu skor zaten var mƒ± kontrol et
            const exists = localScores.find(s => s.timestamp === newScore.timestamp);
            if (exists) {
                console.log("üìã Skor zaten mevcut, atlanƒ±yor");
                return;
            }
            
            // Yeni skoru ekle
            localScores.push(newScore);
            
            // Sƒ±rala
            localScores.sort((a, b) => {
                if (b.score !== a.score) {
                    return b.score - a.score;
                }
                const timeA = convertTimeToSeconds(a.time);
                const timeB = convertTimeToSeconds(b.time);
                return timeA - timeB;
            });
            
            // localStorage'a kaydet
            localStorage.setItem('cyberScores', JSON.stringify(localScores));
            
            console.log("‚ö° Yeni skor eklendi ve sƒ±ralandƒ±:", localScores.length);
            
            // Eƒüer scoreboard a√ßƒ±ksa g√ºncelle
            if (window.location.href.includes('scoreboard.html') || 
                document.getElementById('scoreboard-panel').style.display !== 'none') {
                console.log("üìä Scoreboard g√∂r√ºn√ºr, g√ºncelleniyor...");
                if (typeof displayScoreboard === 'function') {
                    setTimeout(() => displayScoreboard(), 500);
                }
            }
        }

        // Yerel skorlarƒ± aƒüa g√∂nder
        function sendLocalScores() {
            if (!localNetworkChannel) return;
            
            const localScores = getLocalScores();
            console.log("üì§ Yerel skorlar g√∂nderiliyor:", localScores.length);
            
            if (localScores.length > 0) {
                localNetworkChannel.postMessage({
                    type: 'SCORES_RESPONSE',
                    data: localScores
                });
                console.log("‚úÖ Skorlar aƒüa g√∂nderildi:", localScores.length);
            }
        }

        // Aƒüdan gelen temizleme mesajƒ±nƒ± i≈üle
        function handleClearScoresFromNetwork(data) {
            console.log("üóëÔ∏è Oyun ekranƒ±nda aƒüdan skorlarƒ± temizle mesajƒ± alƒ±ndƒ±:", data);
            
            // Kendi localStorage'ƒ±mƒ±zƒ± da temizle
            localStorage.removeItem('cyberScores');
            localStorage.setItem('cyberScores', '[]');
            
            console.log("‚úÖ Oyun ekranƒ±nda skorlar temizlendi");
        }

    // Custom password analysis functions
    function analyzePassword(password) {
    let charsetSize = 0;
    let usedSets = [];

    if (/[a-z]/.test(password)) {
        charsetSize += 26;
        usedSets.push("K√º√ß√ºk harfler");
    }
    if (/[A-Z]/.test(password)) {
        charsetSize += 26;
        usedSets.push("B√ºy√ºk harfler");
    }
    if (/[0-9]/.test(password)) {
        charsetSize += 10;
        usedSets.push("Sayƒ±lar");
    }
    if (/[^a-zA-Z0-9]/.test(password)) {
        charsetSize += 32;
        usedSets.push("Semboller");
    }

    const length = password.length;
    const totalCombinations = Math.pow(charsetSize, length);

    return { length, charsetSize, usedSets, totalCombinations };
    }

    function calculateCrackTimes(password) {
        // Use zxcvbn for more accurate crack time estimation
        const result = zxcvbn(password);
        
        // Get crack time display from zxcvbn
        let crackTimeDisplay = result.crack_times_display.online_no_throttling_10_per_second;
        if (!crackTimeDisplay || typeof crackTimeDisplay !== 'string') {
            crackTimeDisplay = result.crack_times_display.offline_fast_hashing_1e10_per_second + ' (hƒ±zlƒ± hash)';
            if (typeof crackTimeDisplay !== 'string') crackTimeDisplay = 'N/A';
        }
        
        // Localize time units to Turkish
        crackTimeDisplay = crackTimeDisplay
            .replace(/less than a second/gi, '1 saniyeden az')
            .replace(/less than/gi, 'den az')
            .replace(/centuries/gi, 'y√ºzyƒ±l')
            .replace(/century/gi, 'y√ºzyƒ±l')
            .replace(/years?/gi, 'yƒ±l')
            .replace(/year/gi, 'yƒ±l')
            .replace(/months?/gi, 'ay')
            .replace(/month/gi, 'ay')
            .replace(/days?/gi, 'g√ºn')
            .replace(/day/gi, 'g√ºn')
            .replace(/hours?/gi, 'saat')
            .replace(/hour/gi, 'saat')
            .replace(/minutes?/gi, 'dakika')
            .replace(/minute/gi, 'dakika')
            .replace(/seconds?/gi, 'saniye')
            .replace(/second/gi, 'saniye')
            .replace(/instantly/gi, 'anƒ±nda')
            .replace(/instant/gi, 'anƒ±nda');
            
        return {
            crackTimeDisplay: crackTimeDisplay,
            score: result.score,
            feedback: result.feedback
        };
    }

    function getStrengthLevel(score) {
        const strengthLevels = {
            0: '√áok Zayƒ±f',
            1: 'Zayƒ±f', 
            2: 'Orta',
            3: 'ƒ∞yi',
            4: '√áok G√º√ßl√º'
        };
        return strengthLevels[score] || 'Bilinmiyor';
    }   
    

    function getStrengthColor(strength) {
        switch(strength) {
            case "√áok Zayƒ±f": return "#FF0000";
            case "Zayƒ±f": return "#FF4500";
            case "Orta": return "#FFAA00";
            case "ƒ∞yi": return "#32CD32";
            case "√áok G√º√ßl√º": return "#008000";
            default: return "#FFFFFF";
        }
    }

    function getStrengthPoints(strength) {
        switch(strength) {
            case "√áok Zayƒ±f": return 0;
            case "Zayƒ±f": return 10;
            case "Orta": return 20;
            case "ƒ∞yi": return 40;
            case "√áok G√º√ßl√º": return 50;
            default: return 0;
        }
    }

    // Zaman ve puan y√∂netimi
    let timerInterval;
    let timeLeft = 0;
    let totalScore = 0;
    let timerStarted = false;
    let currentUsername = ''; // Kullanƒ±cƒ± adƒ±
    
    // Sayfalama deƒüi≈ükenleri
    let currentPage = 1;
    let allScores = [];
    let scoresPerPage = 6;
    
    // B√∂l√ºm skorlarƒ±
    let passwordScore = 0;
    let shareScore = 0;
    let phishingScore = 0;
    
    // √áoklu Ekran Skor Sistemi (Firebase + LocalStorage Hybrid)
    function saveScore(username, score, time) {
        const newScore = {
            username: username,
            score: score,
            time: time,
            date: new Date().toLocaleDateString('tr-TR'),
            timestamp: Date.now(),
            deviceId: getDeviceId(),
            ageGroup: selectedAgeGroup || 'adult' // Ya≈ü grubu bilgisi ekle
        };
        
        console.log("üíæ Skor kaydediliyor:", {
            score: newScore,
            firebaseEnabled: isFirebaseEnabled,
            databaseExists: database ? "Var" : "Yok"
        });
        
        if (isFirebaseEnabled) {
            // Firebase'e kaydet (t√ºm ekranlar g√∂rebilsin)
            saveScoreToFirebase(newScore);
        } else {
            console.log("üì± Firebase kapalƒ±, yerel kayƒ±t yapƒ±lƒ±yor");
            // Yerel olarak kaydet
            saveScoreLocally(newScore);
        }
    }
    
    function saveScoreToFirebase(newScore) {
        try {
            console.log("üî• Firebase'e skor kaydediliyor:", newScore);
            console.log("üîó Database durumu:", {
                database: database ? "Mevcut" : "Null",
                isFirebaseEnabled: isFirebaseEnabled
            });
            
            // Firebase'e yeni skoru ekle
            const scoresRef = database.ref('scores');
            scoresRef.push(newScore).then(() => {
                console.log("‚úÖ Skor Firebase'e ba≈üarƒ±yla kaydedildi");
                
                // Skor limitini kontrol et ve eski skorlarƒ± temizle
                scoresRef.orderByChild('score').limitToLast(600).once('value', (snapshot) => {
                    const firebaseScores = [];
                    snapshot.forEach((child) => {
                        firebaseScores.push({ key: child.key, ...child.val() });
                    });
                    
                    console.log("üìä Firebase'deki toplam skor sayƒ±sƒ±:", firebaseScores.length);
                    
                    // Sƒ±ralama: √∂nce puan, sonra s√ºre
                    firebaseScores.sort((a, b) => {
                        if (b.score !== a.score) {
                            return b.score - a.score;
                        }
                        const timeA = convertTimeToSeconds(a.time);
                        const timeB = convertTimeToSeconds(b.time);
                        return timeA - timeB;
                    });
                    
                    // En fazla 500 skoru tut, fazlasƒ±nƒ± sil
                    if (firebaseScores.length > 500) {
                        const toDelete = firebaseScores.slice(500);
                        console.log(`üóëÔ∏è ${toDelete.length} eski skor siliniyor...`);
                        toDelete.forEach(scoreToDelete => {
                            scoresRef.child(scoreToDelete.key).remove();
                        });
                    }
                });
            }).catch((error) => {
                console.error("‚ùå Firebase'e skor kaydedilemedi - HATA DETAYI:", error);
                console.error("‚ùå Error message:", error.message);
                console.error("‚ùå Error code:", error.code);
                console.error("‚ùå Database state:", database ? "Mevcut" : "Null");
                console.error("‚ùå isFirebaseEnabled:", isFirebaseEnabled);
                // Hata durumunda yerel olarak kaydet
                saveScoreLocally(newScore);
            });
        } catch (error) {
            console.error("‚ùå Firebase kaydetme hatasƒ± - TRY-CATCH:", error);
            console.error("‚ùå Hata mesajƒ±:", error.message);
            console.error("‚ùå Database durumu:", database);
            saveScoreLocally(newScore);
        }
    }
    
    function saveScoreLocally(newScore) {
        const scores = getLocalScores();
        scores.push(newScore);
        
        scores.sort((a, b) => {
            if (b.score !== a.score) {
                return b.score - a.score;
            }
            const timeA = convertTimeToSeconds(a.time);
            const timeB = convertTimeToSeconds(b.time);
            return timeA - timeB;
        });
        
        // En fazla 50 skor tut (offline backup i√ßin)
        if (scores.length > 50) {
            scores.splice(50);
        }
        
        localStorage.setItem('cyberScores', JSON.stringify(scores));
        
        console.log("‚úÖ Skor yerel olarak kaydedildi:", {
            newScore: newScore,
            totalScores: scores.length,
            localStorageSize: JSON.stringify(scores).length
        });
        
        // Yerel aƒüa anƒ±nda g√∂nder (diƒüer tabletler i√ßin)
        if (localNetworkChannel) {
            localNetworkChannel.postMessage({
                type: 'NEW_SCORE',
                data: newScore
            });
            console.log("‚ö° Yeni skor anƒ±nda yerel aƒüa g√∂nderildi - Diƒüer tabletler g√ºncellendi");
            
            // T√ºm skorlarƒ± da g√∂nder (g√ºvenlik i√ßin)
            setTimeout(() => {
                localNetworkChannel.postMessage({
                    type: 'SCORE_UPDATE',
                    data: scores
                });
            }, 1000);
        }
    }
    
    function getScores() {
        if (isFirebaseEnabled) {
            return getScoresFromFirebase();
        } else {
            return Promise.resolve(getLocalScores());
        }
    }
    
    function getScoresFromFirebase() {
        return new Promise((resolve, reject) => {
            try {
                console.log("üîç Firebase'den skorlar alƒ±nƒ±yor...");
                const scoresRef = database.ref('scores');
                
                // √ñnce veri var mƒ± kontrol et
                scoresRef.once('value', (snapshot) => {
                    console.log("üìä Firebase snapshot alƒ±ndƒ±:", {
                        exists: snapshot.exists(),
                        hasChildren: snapshot.hasChildren(),
                        numChildren: snapshot.numChildren()
                    });
                    
                    const scores = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((child) => {
                            const scoreData = child.val();
                            if (scoreData && scoreData.username && scoreData.score !== undefined) {
                                scores.push(scoreData);
                            } else {
                                console.warn("‚ö†Ô∏è Ge√ßersiz skor verisi:", scoreData);
                            }
                        });
                    }
                    
                    console.log("üìà Firebase'den alƒ±nan skor sayƒ±sƒ±:", scores.length);
                    
                    // Sƒ±ralama: √∂nce puan, sonra s√ºre
                    scores.sort((a, b) => {
                        if (b.score !== a.score) {
                            return b.score - a.score;
                        }
                        const timeA = convertTimeToSeconds(a.time);
                        const timeB = convertTimeToSeconds(b.time);
                        return timeA - timeB;
                    });
                    
                    resolve(scores);
                }, (error) => {
                    console.error("‚ùå Firebase'den skorlar alƒ±namadƒ±:", error);
                    console.log("üîÑ Yerel skorlara ge√ßiliyor...");
                    // Hata durumunda yerel skorlarƒ± d√∂nd√ºr
                    resolve(getLocalScores());
                });
            } catch (error) {
                console.error("Firebase okuma hatasƒ±:", error);
                resolve(getLocalScores());
            }
        });
    }
    
    function getLocalScores() {
        const scores = localStorage.getItem('cyberScores');
        const parsedScores = scores ? JSON.parse(scores) : [];
        
        // Eƒüer localStorage null ise ve hi√ß skor yoksa, demo skorlarƒ± ekle
        // Ama eƒüer localStorage bo≈ü array ([]) ise demo ekleme (temizlenmi≈ü demektir)
        if (scores === null && parsedScores.length === 0) {
            console.log("üéÆ ƒ∞lk defa a√ßƒ±lƒ±yor - Demo skorlarƒ± ekleniyor...");
            const demoScores = [
                {
                    username: "Demo Oyuncu 1",
                    score: 850,
                    time: "2:15",
                    date: new Date().toLocaleDateString('tr-TR'),
                    timestamp: Date.now() - 300000,
                    deviceId: "demo_device_1"
                },
                {
                    username: "Demo Oyuncu 2", 
                    score: 720,
                    time: "3:42",
                    date: new Date().toLocaleDateString('tr-TR'),
                    timestamp: Date.now() - 200000,
                    deviceId: "demo_device_2"
                },
                {
                    username: "Demo Oyuncu 3",
                    score: 650,
                    time: "4:18",
                    date: new Date().toLocaleDateString('tr-TR'),
                    timestamp: Date.now() - 100000,
                    deviceId: "demo_device_3"
                }
            ];
            
            // Demo skorlarƒ± localStorage'a kaydet
            localStorage.setItem('cyberScores', JSON.stringify(demoScores));
            console.log("‚úÖ Demo skorlarƒ± eklendi:", demoScores.length);
            return demoScores;
        } else if (scores === '[]') {
            console.log("üóëÔ∏è Skorlar temizlenmi≈ü durumda - demo eklenmeyecek");
            return [];
        }
        
        console.log("üìä Mevcut skorlar d√∂nd√ºr√ºl√ºyor:", parsedScores.length);
        return parsedScores;
    }
    
    // Ya≈ü grubu se√ßim fonksiyonu
    function selectAgeGroup(ageGroup) {
        selectedAgeGroup = ageGroup;
        // localStorage.setItem('selectedAgeGroup', ageGroup); // Her seferinde sorsun diye kapalƒ±
        
        console.log("üë∂/üë® Ya≈ü grubu se√ßildi:", ageGroup);
        
        // Ana paneli g√∂ster ve ya≈ü grubuna g√∂re √∂zelle≈ütir
        document.getElementById('age-selection-panel').style.display = 'none';
        document.getElementById('main-panel').style.display = 'block';
        
        customizeContentForAgeGroup(ageGroup);
    }
    
    // Ya≈ü grubuna g√∂re i√ßeriƒüi √∂zelle≈ütir
    function customizeContentForAgeGroup(ageGroup) {
        const mainDesc = document.getElementById('main-panel-desc');
        
        if (ageGroup === 'child') {
            mainDesc.textContent = "Siber d√ºnyada maceraya hazƒ±r mƒ±sƒ±n? Oyunu kazan, g√ºvende kal!";
        } else {
            mainDesc.textContent = "Siber sƒ±rlarƒ± √ß√∂z, oyunu kazan, g√ºvende kal!";
        }
        
        console.log("üéØ ƒ∞√ßerik ya≈ü grubuna g√∂re √∂zelle≈ütirildi:", ageGroup);
    }
    
    // Ya≈ü grubuna g√∂re payla≈ü/sakla sorularƒ±nƒ± getir
    function getAgeSpecificShareQuestions() {
        if (selectedAgeGroup === 'child') {
            // √áocuklar i√ßin eski sistem - genel sorular
            return null; // Eski sistemi kullan
        } else {
            // Yeti≈ükinler i√ßin √∂zel sorular
            return [
                {
                    id: 1,
                    question: "TC Kimlik numaranƒ±zƒ± g√ºvenilmeyen sitelerde payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: false,
                    explanation: "TC Kimlik numarasƒ± son derece gizli tutulmasƒ± gereken bir bilgidir."
                },
                {
                    id: 2,
                    question: "Kredi kartƒ± bilgilerinizi g√ºvenli √∂deme sistemleri dƒ±≈üƒ±nda payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: false,
                    explanation: "Kredi kartƒ± bilgileri sadece g√ºvenli √∂deme sistemlerinde kullanƒ±lmalƒ±dƒ±r."
                },
                {
                    id: 3,
                    question: "Hobiler ve ilgi alanlarƒ±nƒ±zƒ± sosyal medyada payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: true,
                    explanation: "Hobiler ve ilgi alanlarƒ± g√ºvenle payla≈üƒ±labilir ve yeni arkada≈ülƒ±klar kurmanƒ±za yardƒ±mcƒ± olur."
                },
                {
                    id: 4,
                    question: "Ev adresinizi a√ßƒ±k kaynaklƒ± platformlarda payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: false,
                    explanation: "Ev adresi son derece √∂zel bilgidir ve asla a√ßƒ±k platformlarda payla≈üƒ±lmamalƒ±dƒ±r. G√ºvenlik riskinizi artƒ±rƒ±r."
                },
                {
                    id: 5,
                    question: "Eƒüitim durumunuzu (√ºniversite, b√∂l√ºm) sosyal medyada payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: true,
                    explanation: "Eƒüitim bilgileri genellikle g√ºvenle payla≈üƒ±labilir ve profesyonel aƒü kurmanƒ±za yardƒ±mcƒ± olur."
                },
                {
                    id: 6,
                    question: "Banka hesap numaranƒ±zƒ± e-posta ile payla≈üƒ±r mƒ±sƒ±nƒ±z?",
                    correct: false,
                    explanation: "Banka hesap numarasƒ± hi√ßbir zaman e-posta ile payla≈üƒ±lmamalƒ±dƒ±r."
                }
            ];
        }
    }
    
    // Ya≈ü grubuna g√∂re oltalama sorularƒ±nƒ± getir
    function getAgeSpecificPhishingQuestions() {
        if (selectedAgeGroup === 'child') {
            return [
                {
                    description: "Yeni oyun kazandƒ±n! Buraya tƒ±kla ve bedava indir!<br>Link adresi: oyunlar-bedava.tk",
                    options: [
                        "Hemen tƒ±klarƒ±m, bedava oyun!",
                        "Annemle konu≈üurum √∂nce", 
                        "Bu sahte olabilir, tƒ±klamam"
                    ],
                    correctIndex: 2,
                    explanation: "Bedava oyun vaat eden siteler √ßoƒüunlukla sahte! √ñnce b√ºy√ºklerinle konu≈ü."
                },
                {
                    description: "Arkada≈üƒ±n sana mesaj attƒ±: 'Bu videoyu izle √ßok komik!'<br>Link adresi: komik-videolar.ml",
                    options: [
                        "Arkada≈üƒ±m g√∂nderdi, g√ºvenlidir",
                        "Bu sahte olabilir, tƒ±klamam",
                        "Direkt tƒ±klarƒ±m"
                    ],
                    correctIndex: 1,
                    explanation: "Bazen k√∂t√º ki≈üiler arkada≈üƒ±n gibi davranabilir. ≈û√ºpheli linklere tƒ±klama!"
                },
                {
                    description: "Tablet oyunu sana diyor: 'Para kazan! Bu linke tƒ±kla!'<br>Link adresi: hizli-para-kazan.cf",
                    options: [
                        "Hemen tƒ±klarƒ±m!",
                        "Bu sahte olabilir, tƒ±klamam",
                        "Param olacak, g√ºzel!"
                    ],
                    correctIndex: 1,
                    explanation: "√áocuklar para kazanamaz bu ≈üekilde! Bu bir tuzak, sakƒ±n tƒ±klama."
                }
            ];
        } else {
            return [
                {
                    description: "Instagram ≈üifrenizi g√ºncellemeniz gerekiyor. Buraya tƒ±klayƒ±n.<br>Link adresi: insta-security.verify-update.ru",
                    options: [
                        "Link ger√ßek gibi, tƒ±klarƒ±m.",
                        "Adres tuhaf, dikkatli olurum.",
                        "≈ûifreyi yazar ge√ßerim."
                    ],
                    correctIndex: 1,
                    explanation: "URL'deki .ru uzantƒ±sƒ± ve garip alan adƒ± ≈ü√ºpheli! Instagram asla b√∂yle linkler g√∂ndermez."
                },
                {
                    description: "Bankanƒ±zdan acil g√ºvenlik bildirimi: Hesabƒ±nƒ±z askƒ±ya alƒ±ndƒ±!<br>Link adresi: garanti-bankasi-guvenlik.tk",
                    options: [
                        "Hemen tƒ±klarƒ±m, hesabƒ±m √∂nemli!",
                        "Adres ≈ü√ºpheli, bankamƒ± ararƒ±m.",
                        "Bilgilerimi girip kontrol ederim."
                    ],
                    correctIndex: 1,
                    explanation: "Bankalar asla acil durumlar i√ßin e-posta g√∂ndermez. Her zaman bankayƒ± direkt arayƒ±n."
                },
                {
                    description: "E-Devlet'ten size √∂nemli bir bildirim geldi.<br>Link adresi: edevlet-bildirim.ml",
                    options: [
                        "Devlet sitesi, g√ºvenilir.",
                        "Sahte site olabilir, resmi siteyi kontrol ederim.",
                        "Direkt tƒ±klarƒ±m."
                    ],
                    correctIndex: 1,
                    explanation: "E-Devlet sadece .gov.tr uzantƒ±sƒ±nƒ± kullanƒ±r. Sahte devlet siteleri √ßok tehlikeli!"
                }
            ];
        }
    }
    
    // Her cihaz i√ßin benzersiz ID olu≈ütur
    function getDeviceId() {
        let deviceId = localStorage.getItem('deviceId');
        if (!deviceId) {
            deviceId = 'device_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
            localStorage.setItem('deviceId', deviceId);
        }
        return deviceId;
    }
    
    // Ana oyun skorboard'u i√ßin ekran boyutuna g√∂re maksimum skor sayƒ±sƒ± (Her sayfada 6 skor)
    function getMaxDisplayScores() {
        // Her sayfada sabit 6 skor g√∂ster
        return 6;
    }
    
    function convertTimeToSeconds(timeString) {
        const parts = timeString.split(':');
        return parseInt(parts[0]) * 60 + parseInt(parts[1]);
    }
    
    function displayScoreboard() {
        const scoreboardList = document.getElementById('scoreboard-list');
        
        // Y√ºkleniyor mesajƒ± g√∂ster
        scoreboardList.innerHTML = '<div style="text-align: center; color: #ffaa00; padding: 20px;">üìä Skorlar y√ºkleniyor...</div>';
        
        getScores().then(scores => {
            allScores = scores; // Global deƒüi≈ükene kaydet
            
            if (scores.length === 0) {
                scoreboardList.innerHTML = '<div style="text-align: center; color: #cccccc; padding: 20px;">Hen√ºz kayƒ±tlƒ± skor yok.</div>';
                updatePaginationControls(0);
                return;
            }
            
            displayCurrentPage();
            updatePaginationControls(scores.length);
        }).catch(error => {
            console.error('Skorlar y√ºklenirken hata:', error);
            scoreboardList.innerHTML = '<div style="text-align: center; color: #ff4444; padding: 20px;">‚ùå Skorlar y√ºklenemedi. Tekrar deneyin.</div>';
            updatePaginationControls(0);
        });
    }
    
    function displayCurrentPage() {
        const scoreboardList = document.getElementById('scoreboard-list');
        scoreboardList.innerHTML = '';
        
        console.log(`üìÑ Sayfa g√∂steriliyor: ${currentPage}, Toplam skor: ${allScores.length}, Sayfa ba≈üƒ±na: ${scoresPerPage}`);
        
        // Mevcut sayfa i√ßin skorlarƒ± hesapla
        const startIndex = (currentPage - 1) * scoresPerPage;
        const endIndex = startIndex + scoresPerPage;
        const displayScores = allScores.slice(startIndex, endIndex);
        
        console.log(`üìä G√∂sterilecek skorlar: ${displayScores.length} (${startIndex} - ${endIndex})`);
        
        displayScores.forEach((score, index) => {
            const row = document.createElement('div');
            row.className = 'scoreboard-row';
            const globalIndex = startIndex + index;
            if (globalIndex === 0) row.classList.add('top-score');
            
            // Device indicator ekle
            const deviceIndicator = score.deviceId ? 
                `<span style="font-size: 0.7rem; color: #888; margin-left: 5px;">üì±</span>` : '';
            
            row.innerHTML = `
                <span class="scoreboard-rank">${globalIndex + 1}</span>
                <span class="scoreboard-name">${score.username}${deviceIndicator}</span>
                <span class="scoreboard-score">${score.score}</span>
                <span class="scoreboard-time">${score.time}</span>
                <span class="scoreboard-date">${score.date}</span>
            `;
            
            scoreboardList.appendChild(row);
        });
        
        // Firebase durumu console'da yazdƒ±r (ekranda g√∂r√ºnmez)
        if (isFirebaseEnabled) {
            console.log('üåê √áoklu ekran modu aktif - T√ºm cihazlardan skorlar');
        } else {
            console.log('üíæ Yerel mod - Sadece bu cihazƒ±n skorlarƒ±');
        }
    }
    
    function updatePaginationControls(totalScores) {
        const totalPages = Math.ceil(totalScores / scoresPerPage);
        const pageInfo = document.getElementById('page-info');
        const prevBtn = document.getElementById('prev-page-btn');
        const nextBtn = document.getElementById('next-page-btn');
        
        console.log(`üéõÔ∏è Pagination g√ºncelleniyor: Sayfa ${currentPage}/${totalPages}, Toplam skor: ${totalScores}`);
        
        if (pageInfo) {
            pageInfo.textContent = `Sayfa ${currentPage} / ${totalPages || 1}`;
        }
        
        if (prevBtn) {
            prevBtn.disabled = currentPage <= 1;
            prevBtn.style.opacity = currentPage <= 1 ? '0.5' : '1';
            console.log(`‚¨ÖÔ∏è √ñnceki buton: ${currentPage <= 1 ? 'Disabled' : 'Enabled'}`);
        }
        
        if (nextBtn) {
            nextBtn.disabled = currentPage >= totalPages;
            nextBtn.style.opacity = currentPage >= totalPages ? '0.5' : '1';
            console.log(`‚û°Ô∏è Sonraki buton: ${currentPage >= totalPages ? 'Disabled' : 'Enabled'}`);
        }
    }
    
    // Ana oyunda ger√ßek zamanlƒ± skorboard i√ßin dinleyici kurulumu
    function setupGameRealtimeScoreboard() {
        if (isFirebaseEnabled) {
            console.log("üéÆ Ana oyun: Ger√ßek zamanlƒ± skorboard dinleyicisi ba≈ülatƒ±lƒ±yor...");
            const scoresRef = database.ref('scores');
            
            // Skorboard a√ßƒ±k olduƒüunda ger√ßek zamanlƒ± g√ºncelleme
            scoresRef.on('value', function(snapshot) {
                // Sadece skorboard paneli a√ßƒ±ksa g√ºncelle
                const scoreboardPanel = document.getElementById('scoreboard-panel');
                if (scoreboardPanel && scoreboardPanel.style.display !== 'none') {
                    console.log("üîÑ Ana oyun: Skorboard ger√ßek zamanlƒ± g√ºncellendi");
                    displayScoreboard();
                }
            });
            
            console.log("‚úÖ Ana oyun: Ger√ßek zamanlƒ± skorboard hazƒ±r!");
        }
    }

    function startTimer() {
        if (timerStarted) return;
        timerStarted = true;
        timeLeft = 0;
        updateTimer();
        timerInterval = setInterval(() => {
            timeLeft++;
            updateTimer();
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timerInterval);
        timerStarted = false;
    }

    function updateTimer() {
        const min = String(Math.floor(timeLeft / 60)).padStart(2, '0');
        const sec = String(timeLeft % 60).padStart(2, '0');
        const timeText = `S√ºre: ${min}:${sec}`;
        
        // T√ºm timer elementlerini g√ºncelle
        const timerElements = ['timer', 'timer-share', 'timer-phishing'];
        timerElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = timeText;
            }
        });
    }

    function setScore(val) {
        totalScore = val;
        
        // T√ºm skor elementlerini g√ºncelle
        const scoreElements = ['score', 'score-share', 'score-phishing'];
        scoreElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = totalScore;
            }
        });
    }

    function addScore(val) {
        totalScore += val;
        
        // T√ºm skor elementlerini g√ºncelle
        const scoreElements = ['score', 'score-share', 'score-phishing'];
        scoreElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = totalScore;
            }
        });
    }

    document.getElementById('start-btn').onclick = function() {
        playButtonClickSound(); // Ses efekti ekle
        document.getElementById('main-panel').style.display = 'none';
        document.getElementById('username-panel').style.display = 'flex';
        // Username input'una odaklan
        setTimeout(() => {
            document.getElementById('username-input').focus();
        }, 100);
    };

    document.getElementById('play-btn').onclick = function() {
        const usernameInput = document.getElementById('username-input');
        const username = usernameInput.value.trim();
        
        // ƒ∞sim kontrol√º - bo≈ü olmamalƒ±
        if (!username || username.length === 0) {
            alert('L√ºtfen kod adƒ±nƒ±zƒ± giriniz!');
            usernameInput.focus(); // Input alanƒ±na odaklan
            return; // ƒ∞sim girilmemi≈üse devam etme
        }
        
        // ƒ∞sim √ßok kƒ±sa olmamalƒ±
        if (username.length < 2) {
            alert('Kod adƒ±nƒ±z en az 2 karakter olmalƒ±dƒ±r!');
            usernameInput.focus();
            return;
        }
        
        // ƒ∞sim √ßok uzun olmamalƒ±
        if (username.length > 20) {
            alert('Kod adƒ±nƒ±z en fazla 20 karakter olabilir!');
            usernameInput.focus();
            return;
        }
        
        // Username'i global deƒüi≈ükene kaydet
        currentUsername = username;
        
        playStartGameSound(); // Oyun ba≈ülama ses efekti
        
        document.getElementById('username-panel').style.display = 'none';
        document.getElementById('password-panel').style.display = 'flex';
        
        // Ana ekrana d√∂n butonunu g√∂ster
        document.getElementById('home-button').style.display = 'block';
        
        startTimer();
        setScore(0);
        
        // Parola inputlarƒ± i√ßin event listener ekle
        setupPasswordValidation();
    };

    // Enter tu≈üu ile de oyuna ba≈ülayabilme
    document.getElementById('username-input').addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            document.getElementById('play-btn').click();
        }
    });

    function setupPasswordValidation() {
        const password1 = document.getElementById('password-input-1');
        const password2 = document.getElementById('password-input-2');
        const button = document.getElementById('check-password-btn');
        const message = document.getElementById('password-match-message');

        function validatePasswords() {
            const pass1 = password1.value;
            const pass2 = password2.value;
            
            // Eƒüer her iki alan da bo≈üsa hi√ßbir ≈üey g√∂sterme
            if (!pass1 && !pass2) {
                message.textContent = '';
                button.style.opacity = '0.5';
                button.style.pointerEvents = 'none';
                return;
            }
            
            // Eƒüer sadece birinci alan doluysa
            if (pass1 && !pass2) {
                message.textContent = 'L√ºtfen parolayƒ± tekrar girin';
                message.style.color = '#ffaa00';
                button.style.opacity = '0.5';
                button.style.pointerEvents = 'none';
                return;
            }
            
            // Her iki alan da doluysa kontrol et
            if (pass1 && pass2) {
                if (pass1 === pass2) {
                    if (pass1.length > 12) {
                        message.textContent = 'Parola 12 karakterden uzun olamaz!';
                        message.style.color = '#ff4444';
                        button.style.opacity = '0.5';
                        button.style.pointerEvents = 'none';
                    } else {
                        message.textContent = 'Parolalar e≈üle≈üiyor ‚úì';
                        message.style.color = '#39b54a';
                        button.style.opacity = '1';
                        button.style.pointerEvents = 'auto';
                    }
                } else {
                    message.textContent = 'Parolalar e≈üle≈ümiyor!';
                    message.style.color = '#ff4444';
                    button.style.opacity = '0.5';
                    button.style.pointerEvents = 'none';
                }
            }
        }

        // Her iki input'a da event listener ekle
        password1.addEventListener('input', validatePasswords);
        password2.addEventListener('input', validatePasswords);
        
        // Enter tu≈üu ile kontrol (sadece parolalar e≈üle≈üiyorsa)
        password1.addEventListener('keyup', function(event) {
            if (event.key === 'Enter' && button.style.pointerEvents === 'auto') {
                button.click();
            }
        });
        password2.addEventListener('keyup', function(event) {
            if (event.key === 'Enter' && button.style.pointerEvents === 'auto') {
                button.click();
            }
        });
    }

    document.getElementById('check-password-btn').onclick = function() {
        const password = document.getElementById('password-input-1').value;
        const confirmPassword = document.getElementById('password-input-2').value;
        
        // Eƒüer parolalar e≈üle≈ümiyorsa i≈ülem yapma
        if (!password || !confirmPassword || password !== confirmPassword) {
            return;
        }
        
        if (password.length > 12) {
            alert('Parola 12 karakterden uzun olamaz!');
            return;
        }

        // Input kutularƒ±nƒ± ve a√ßƒ±klama metnini gizle
        document.getElementById('password-desc').style.display = 'none';
        document.getElementById('password-input-wrapper').style.display = 'none';
        document.getElementById('password-confirm-wrapper').style.display = 'none';
        document.getElementById('password-match-message').style.display = 'none';
        document.getElementById('password-check-btn-wrapper').style.display = 'none';
        
        // Use zxcvbn for accurate password analysis (like in old code)
        const result = calculateCrackTimes(password);
        const strength = getStrengthLevel(result.score);
        const color = getStrengthColor(strength);
        const points = getStrengthPoints(strength);
        
        passwordScore = points; // Parola puanƒ±nƒ± kaydet
        addScore(points);
        
        // Parola g√ºc√ºne g√∂re ses √ßal
        playPasswordStrengthSound(strength);
        
        document.getElementById('password-result').style.display = 'flex';
        document.getElementById('password-result').innerHTML = `
            <div id="strength-label"><span class="strength-badge" style="background:${color};color:#fff;">G√º√ß: ${strength}</span></div>
            <div id="crack-time">‚ö° Kƒ±rƒ±lma S√ºresi: ${result.crackTimeDisplay}</div>
            <div id="congrats-message">Tebrikler! Parolanƒ±zƒ±n g√ºc√ºn√º test ettiniz.</div>
            <div id="password-tips" style="
                background: linear-gradient(135deg, rgba(0, 255, 153, 0.1), rgba(51, 255, 153, 0.1));
                border: 1px solid rgba(0, 255, 153, 0.3);
                border-radius: 8px;
                padding: 2px;
                margin: 10px 0;
                font-size: 0.8rem;
                line-height: 1.2;
                color: #ffffff;
                text-align: center;
                max-width: 90%;
                margin-left: auto;
                margin-right: auto;
            ">
                <div style="color: #00ff99; font-weight: bold; margin-bottom: 5px;">
                    üîê G√º√ßl√º Parola ƒ∞pu√ßlarƒ±
                </div>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; font-size: 0.75rem;">
                    <span style="background: rgba(0,255,153,0.2); padding: 3px 6px; border-radius: 4px;">12+ karakter</span>
                    <span style="background: rgba(0,255,153,0.2); padding: 3px 6px; border-radius: 4px;">A-z karƒ±≈üƒ±mƒ±</span>
                    <span style="background: rgba(0,255,153,0.2); padding: 3px 6px; border-radius: 4px;">0-9 rakamlar</span>
                    <span style="background: rgba(0,255,153,0.2); padding: 3px 6px; border-radius: 4px;">!@#$ semboller</span>
                </div>
                <div style="color: #ffaa00; font-size: 0.7rem; margin-top: 5px;">
                    ‚ö†Ô∏è Ki≈üisel bilgilerden ka√ßƒ±nƒ±n!
                </div>
            </div>
            <div id="next-task-btn" class="next-task-btn" style="display:block;">
                <img src="assets/Asset 35.svg" alt="Payla≈ü/Sakla G√∂revine Ge√ß">
            </div>
        `;
        
        // ≈ûifre g√ºc√ºne g√∂re crack-time i√ßin CSS sƒ±nƒ±fƒ± ekle
        const crackTimeElement = document.getElementById('crack-time');
        if (crackTimeElement) {
            // Mevcut sƒ±nƒ±flarƒ± temizle
            crackTimeElement.className = '';
            
            // ≈ûifre g√ºc√ºne g√∂re sƒ±nƒ±f ekle
            switch(strength) {
                case '√áok Zayƒ±f':
                    crackTimeElement.classList.add('very-weak');
                    break;
                case 'Zayƒ±f':
                    crackTimeElement.classList.add('weak');
                    break;
                case 'Orta':
                    crackTimeElement.classList.add('medium');
                    break;
                case 'ƒ∞yi':
                    crackTimeElement.classList.add('good');
                    break;
                case '√áok G√º√ßl√º':
                    crackTimeElement.classList.add('very-strong');
                    break;
            }
        }
    };

    // PAYLA≈û/SAKLA butonuna tƒ±klanƒ±nca panel ge√ßi≈üi
    document.addEventListener('click', function(e) {
        if (e.target.closest('#next-task-btn')) {
            playTransitionSound(); // Ge√ßi≈ü ses efekti
            document.getElementById('password-panel').style.display = 'none';
            document.getElementById('share-panel').style.display = 'flex';
            
            // Yeni share panel sistemini ba≈ülat
            displayShareQuestions();
        }
        
                                  // Phishing testine ge√ßi≈ü butonu
         if (e.target.closest('#phishing-test-btn')) {
             document.getElementById('share-panel').style.display = 'none';
             document.getElementById('phishing-panel').style.display = 'flex';
             
             // ƒ∞lk phishing sorusunu ba≈ülat
             currentPhishingQuestion = 0;
             showNextPhishingQuestion();
         }
         
         // Ana ekrana d√∂n butonu
         if (e.target.closest('#final-back-btn')) {
             console.log("üîÑ Final skor panelinden ana ekrana d√∂n√º≈ü");
             
             // Final skor panelini gizle
             document.getElementById('final-score-panel').style.display = 'none';
             
             // T√ºm panelleri gizle
             document.getElementById('main-panel').style.display = 'none';
             document.getElementById('password-panel').style.display = 'none';
             document.getElementById('share-panel').style.display = 'none';
             document.getElementById('phishing-panel').style.display = 'none';
             document.getElementById('scoreboard-panel').style.display = 'none';
             
             // Ya≈ü se√ßimi sƒ±fƒ±rla ve g√∂ster
             selectedAgeGroup = null;
             document.getElementById('age-selection-panel').style.display = 'block';
             console.log("‚úÖ Ya≈ü se√ßimi yeniden g√∂steriliyor");
             
             // Kullanƒ±cƒ± adƒ± input'unu temizle
             const usernameInput = document.getElementById('username-input');
             if (usernameInput) {
                 usernameInput.value = '';
             }
             
             // Oyunu tamamen sƒ±fƒ±rla
             totalScore = 0;
             passwordScore = 0;
             shareScore = 0;
             phishingScore = 0;
             timeLeft = 0;
             timerStarted = false;
             currentPhishingQuestion = 0;
             
             // Timer'ƒ± durdur
             if (timerInterval) {
                 clearInterval(timerInterval);
                 timerInterval = null;
             }
             
             // Parola panelini sƒ±fƒ±rla
             const passwordInput = document.getElementById('password-input-1');
             const confirmPasswordInput = document.getElementById('password-input-2');
             if (passwordInput) passwordInput.value = '';
             if (confirmPasswordInput) confirmPasswordInput.value = '';
             
             // Parola a√ßƒ±klamasƒ±nƒ± sƒ±fƒ±rla
             const passwordDescFinal = document.getElementById('password-desc');
             if (passwordDescFinal) {
                 passwordDescFinal.textContent = 'Parolanƒ±zƒ± girin ve g√ºc√ºn√º test edin.';
                 passwordDescFinal.style.color = ''; // Varsayƒ±lan renk
             }
             
             // Parola kontrol butonunu sƒ±fƒ±rla
             const checkBtn = document.getElementById('check-password-btn');
             const checkBtnWrapper = document.getElementById('password-check-btn-wrapper');
             if (checkBtn) {
                 checkBtn.style.opacity = '0.5';
                 checkBtn.style.pointerEvents = 'none';
                 checkBtn.style.display = 'block';
             }
             if (checkBtnWrapper) {
                 checkBtnWrapper.style.display = 'flex';
             }
             
             // Parola match mesajƒ±nƒ± temizle
             const matchMessage = document.getElementById('password-match-message');
             if (matchMessage) {
                 matchMessage.textContent = '';
             }
             
             // Input wrapper'larƒ± g√∂ster
             const passwordWrapper = document.getElementById('password-input-wrapper');
             const confirmWrapper = document.getElementById('password-confirm-wrapper');
             if (passwordWrapper) passwordWrapper.style.display = 'flex';
             if (confirmWrapper) confirmWrapper.style.display = 'flex';
             
             // A√ßƒ±klamayƒ± sƒ±fƒ±rla
             const passwordDesc = document.getElementById('password-desc');
             if (passwordDesc) {
                 passwordDesc.textContent = 'Parolanƒ±zƒ± girin ve g√ºc√ºn√º test edin.';
             }
             
             // Parola g√º√ß sonu√ßlarƒ±nƒ± temizle
             const strengthLabel = document.getElementById('strength-label');
             const crackTime = document.getElementById('crack-time');
             const congratsMessage = document.getElementById('congrats-message');
             if (strengthLabel) strengthLabel.textContent = '';
             if (crackTime) crackTime.textContent = '';
             if (congratsMessage) congratsMessage.textContent = '';
             
             // Parola sonu√ßlarƒ±nƒ± temizle
             const passwordResult = document.querySelector('.password-result');
             if (passwordResult) passwordResult.style.display = 'none';
             
             const nextTaskBtn = document.getElementById('next-task-btn');
             if (nextTaskBtn) nextTaskBtn.style.display = 'none';
             
             // Share panel'ƒ± sƒ±fƒ±rla (yeni sistem)
             selectedAnswers = {};
             shareQuestionsDisplayed = false;
             
             // Share panel √∂ƒüelerini temizle
             const shareContainer = document.getElementById('share-questions-container');
             const shareResults = document.getElementById('share-results');
             const shareSubmitBtn = document.getElementById('continue-to-phishing-btn');
             
             if (shareContainer) {
                 // Mevcut sorularƒ±n pointer-events'lerini sƒ±fƒ±rla
                 const existingQuestions = shareContainer.querySelectorAll('.share-question-item');
                 existingQuestions.forEach(q => {
                     q.style.pointerEvents = 'auto';
                     q.style.opacity = '1';
                     q.classList.remove('selected', 'correct', 'wrong');
                 });
                 shareContainer.innerHTML = '';
             }
             if (shareResults) {
                 shareResults.style.display = 'none';
                 shareResults.innerHTML = '';
             }
             if (shareSubmitBtn) shareSubmitBtn.style.display = 'block';
             
             // Share panel a√ßƒ±klamasƒ±nƒ± sƒ±fƒ±rla
             const shareDesc = document.querySelector('#share-panel .password-desc');
             if (shareDesc) {
                 shareDesc.textContent = 'A≈üaƒüƒ±daki bilgilerden hangilerini g√ºvenle payla≈üabileceƒüini se√ß:';
             }
             
             // Phishing panel'ƒ± sƒ±fƒ±rla
             currentPhishingQuestion = 0;
             
             // Phishing panel a√ßƒ±klamasƒ±nƒ± temizle
                 const phishingExplanation = document.getElementById('phishing-explanation');
    if (phishingExplanation) {
        phishingExplanation.textContent = '';
        phishingExplanation.className = 'share-explanation';
    }
             
             // Phishing butonlarƒ±nƒ± sƒ±fƒ±rla
             const phishingButtons = document.querySelectorAll('.phishing-button');
             phishingButtons.forEach(btn => {
                 btn.style.pointerEvents = 'auto';
                 btn.style.opacity = '1';
                 btn.style.transform = 'scale(1)';
             });
             
             // Skor ve timer'ƒ± sƒ±fƒ±rla
             setScore(0);
             updateTimer();
             
             // Skor tablosunu g√ºncelle
             const scoreElements = ['score', 'score-share', 'score-phishing'];
             scoreElements.forEach(id => {
                 const element = document.getElementById(id);
                 if (element) {
                     element.textContent = '0';
                 }
             });
         }
        
                 // Phishing test butonlarƒ±
         if (e.target.closest('.phishing-button')) {
             const button = e.target.closest('.phishing-button');
             const isCorrect = button.getAttribute('data-answer') === 'correct';
             const explanation = document.getElementById('phishing-explanation');
             
             console.log("üéØ Phishing buton tƒ±klandƒ±:", {
                 currentQuestion: currentPhishingQuestion,
                 isCorrect: isCorrect,
                 questionText: phishingQuestions[currentPhishingQuestion]?.text
             });
             
             // Phishing ses efektini √ßal
             playPhishingSound(isCorrect);
             
             if (isCorrect) {
                 phishingScore += 10;
                 addScore(10);
                 explanation.textContent = phishingQuestions[currentPhishingQuestion].explanation;
                 explanation.className = 'share-explanation correct';
                 console.log("‚úÖ Doƒüru cevap! +10 puan");
             } else {
                 phishingScore -= 5;
                 addScore(-5);
                 explanation.textContent = phishingQuestions[currentPhishingQuestion].explanation;
                 explanation.className = 'share-explanation wrong';
                 console.log("‚ùå Yanlƒ±≈ü cevap! -5 puan");
             }
             
             // Butonlarƒ± devre dƒ±≈üƒ± bƒ±rak
             const allButtons = document.querySelectorAll('.phishing-button');
             allButtons.forEach(btn => {
                 btn.style.pointerEvents = 'none';
                 btn.style.opacity = '0.7';
                 btn.style.transform = 'none';
             });
             
                         // 4 saniye sonra bir sonraki soruya ge√ß (√ßocuklarƒ±n a√ßƒ±klamayƒ± okuyabilmesi i√ßin)
            setTimeout(() => {
                currentPhishingQuestion++;
                console.log("‚è≠Ô∏è Sonraki soruya ge√ßiliyor:", currentPhishingQuestion);
                showNextPhishingQuestion();
            }, 4000);
         }
    });

    // Phishing butonlarƒ± i√ßin hover efekti
    document.addEventListener('mouseover', function(e) {
        if (e.target.closest('.phishing-button') && e.target.closest('.phishing-button').style.pointerEvents !== 'none') {
            e.target.closest('.phishing-button').style.transform = 'scale(1.02)';
        }
    });

    document.addEventListener('mouseout', function(e) {
        if (e.target.closest('.phishing-button') && e.target.closest('.phishing-button').style.pointerEvents !== 'none') {
            e.target.closest('.phishing-button').style.transform = 'scale(1)';
        }
    });

    // PHISHING TEST - √áoklu Soru Sistemi
    let phishingQuestions = [
        {
    text: "TikTok'ta viral olan bir challenge videosunda yorum g√∂rd√ºn: 'Bu challenge'ƒ± yapmak i√ßin ≈üifre123 kullan, s√ºper havalƒ± hesap a√ß!'\nNe yaparsƒ±n?",
    options: [
        { text: "Bu g√ºvensiz g√∂r√ºn√ºyor, kendi g√º√ßl√º ≈üifremi olu≈ütururum", correct: true },
        { text: "Hemen ≈üifre123'√º kullanarak hesap a√ßarƒ±m", correct: false },
        { text: "Arkada≈ülarƒ±ma da bu ≈üifreyi s√∂ylerim", correct: false }
    ],
    explanation: "Herkesin kullandƒ±ƒüƒ± basit ≈üifreler √ßok tehlikeli! Her zaman kendi benzersiz ve g√º√ßl√º ≈üifreni olu≈ütur. ≈ûifreleri asla payla≈üma."
},
{
    text: "YouTube'da en sevdiƒüin youtuber'ƒ±n videosunda a√ßƒ±klama kƒ±smƒ±nda link var:\n '√úCRETSƒ∞Z ROBUx KAZANMAK ƒ∞√áƒ∞N TIKLA!'\nNe yaparsƒ±n?",
    options: [
        { text: "Hemen tƒ±klarƒ±m, √ºcretsiz Robux istiyorum!", correct: false },
        { text: "Linki kopyalayƒ±p arkada≈ülarƒ±ma g√∂nderirim", correct: false },
        { text: "Bu bir tuzak, youtuber'ƒ±n ger√ßek olup olmadƒ±ƒüƒ±nƒ± kontrol ederim", correct: true }
    ],
    explanation: "√úcretsiz oyun parasƒ± vaat eden linkler genellikle dolandƒ±rƒ±cƒ±lƒ±k!\n\n Ger√ßek YouTuber'lar b√∂yle ≈üeyler payla≈ümaz. Her zaman ≈ü√ºpheli ol."
},
{
    text: "WhatsApp'ta tanƒ±madƒ±ƒüƒ±n bir numaradan mesaj geliyor: 'Merhaba! Okul arkada≈üƒ±nƒ±m, telefon numaramƒ± deƒüi≈ütirdim. Acil para lazƒ±m, annene s√∂yle l√ºtfen.'\nNe yaparsƒ±n?",
    options: [
        { text: "Hemen anneme s√∂ylerim, arkada≈üƒ±m yardƒ±ma ihtiyacƒ± var", correct: false },
        { text: "Bu ≈ü√ºpheli, √∂nce kimliƒüini doƒürulayacaƒüƒ±m sorular sorarƒ±m", correct: true },
        { text: "Para g√∂ndermek i√ßin banka bilgilerini sorarƒ±m", correct: false }
    ],
    explanation: "Bu klasik bir dolandƒ±rƒ±cƒ±lƒ±k y√∂ntemi! Tanƒ±madƒ±ƒüƒ±n numaralardan gelen para isteklerine asla g√ºvenme. √ñnce kimliƒüi doƒürula."
},
{
    text: "Discord'da oyun oynarken biri √∂zel mesaj atƒ±yor: 'Hey! Minecraft server'ƒ±mƒ±za katƒ±l, admin olmak ister misin? ≈ûifreni ver, seni yetkili yapayƒ±m.'\nNe yaparsƒ±n?",
    options: [
        { text: "S√ºper! Hemen ≈üifremi veririm, admin olmak istiyorum", correct: false },
        { text: "√ñnce arkada≈ülarƒ±ma sorayƒ±m, onlar da admin olmak isteyebilir", correct: false },
        { text: "≈ûifremi asla kimseyle payla≈ümam, bu bir tuzak", correct: true }
    ],
    explanation: "Oyun ≈üifrelerini ASLA kimseyle payla≈üma! Ger√ßek admin'ler ≈üifreni istemez. Bu hesap √ßalma y√∂ntemidir."
},
{
    text: "Instagram'da tanƒ±nmƒ±≈ü bir markanƒ±n sahte hesabƒ±ndan mesaj aldƒ±n: 'TEBRƒ∞KLER! iPhone 15 kazandƒ±n! Almak i√ßin bu linke tƒ±kla ve bilgilerini gir: fakeapple-giveaway.com'\nNe yaparsƒ±n?",
    options: [
        { text: "Harika! Hemen tƒ±klayƒ±p bilgilerimi giriyorum", correct: false },
        { text: "Bu sahte g√∂r√ºn√ºyor, ger√ßek marka hesabƒ±nƒ± kontrol ederim", correct: true },
        { text: "Linki arkada≈ülarƒ±ma da g√∂nderiyorum, onlar da kazanabilir", correct: false }
    ],
    explanation: "Sahte hediye √ßekili≈üleri √ßok yaygƒ±n!\n\n Ger√ßek markalar resmi hesaplarƒ±ndan a√ßƒ±klama yapar. Domain adƒ±na dikkat et, sahte siteler farklƒ± uzantƒ± kullanƒ±r."
}
    ];
    
    let currentPhishingQuestion = 0;
    
    function showNextPhishingQuestion() {
        console.log("üéØ Phishing soru g√∂steriliyor:", currentPhishingQuestion);
        
        // DOM elementlerinin varlƒ±ƒüƒ±nƒ± kontrol et
        const desc = document.getElementById('phishing-desc');
        const buttons = document.querySelectorAll('.phishing-button');
        const explanation = document.getElementById('phishing-explanation');
        
        if (!desc || buttons.length === 0) {
            console.error("‚ùå Phishing DOM elementleri bulunamadƒ±! Tekrar deneniyor...");
            // 500ms sonra tekrar dene
            setTimeout(() => {
                showNextPhishingQuestion();
            }, 500);
            return;
        }
        
        if (currentPhishingQuestion >= phishingQuestions.length) {
            console.log("‚úÖ T√ºm phishing sorularƒ± tamamlandƒ±");
            // T√ºm sorular tamamlandƒ±
            desc.textContent = 'Tebrikler! Phishing testini tamamladƒ±n!';
            
            // Butonlarƒ± gizle
            const container = document.querySelector('.phishing-buttons-container');
            if (container) {
                container.style.display = 'none';
            }
            
            // A√ßƒ±klama g√∂ster
            if (explanation) {
                explanation.innerHTML = `
                    <div style="color: #ffffff; font-size: 1rem;">Oyun tamamlandƒ±!</div>
                `;
            }
            
            // 0.9 saniye sonra final skor panelini g√∂ster
            setTimeout(() => {
                showFinalScorePanel();
            }, 900);
            return;
        }
        
        const question = phishingQuestions[currentPhishingQuestion];
        console.log("üìù G√∂sterilen soru:", question.description);
        
        // Soruyu g√ºncelle
        desc.innerHTML = question.description.replace(/\n/g, '<br>');
        
        // Butonlarƒ± g√ºncelle
        buttons.forEach((button, index) => {
            if (index < question.options.length) {
                // Text div'ini bul veya olu≈ütur
                let textDiv = button.querySelector('div');
                if (!textDiv) {
                    // Eƒüer div yoksa olu≈ütur
                    textDiv = document.createElement('div');
                    textDiv.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: "Gilmer Light", sans-serif; font-size: 1rem; text-align: center; width: 90%; line-height: 1.2;';
                    button.appendChild(textDiv);
                }
                
                textDiv.textContent = question.options[index];
                button.setAttribute('data-answer', index === question.correctIndex ? 'correct' : 'wrong');
                button.style.pointerEvents = 'auto';
                button.style.opacity = '1';
                button.style.transform = 'scale(1)';
                button.style.display = 'block';
                
                console.log(`üîò Buton ${index + 1}:`, question.options[index]);
            } else {
                button.style.display = 'none';
            }
        });
        
        // A√ßƒ±klamayƒ± temizle
        if (explanation) {
            explanation.textContent = '';
            explanation.className = 'share-explanation';
        }
        
        // Container'ƒ± g√∂r√ºn√ºr yap
        const container = document.querySelector('.phishing-buttons-container');
        if (container) {
            container.style.display = 'flex';
        }
        
        console.log("‚úÖ Phishing sorusu ba≈üarƒ±yla y√ºklendi");
        
        // ƒ∞lk soru ba≈üarƒ±yla y√ºklendiyse timeout'u iptal et
        if (currentPhishingQuestion === 0 && window.phishingTimeoutId) {
            clearTimeout(window.phishingTimeoutId);
            window.phishingTimeoutId = null;
            console.log("‚úÖ Phishing test timeout iptal edildi - ba≈üarƒ±yla y√ºklendi");
        }
    }
     
     // Final skor panelini g√∂ster
     function showFinalScorePanel() {
         // Zafer sesini √ßal
         playFinalVictorySound();
         
         // Phishing panelini gizle
         document.getElementById('phishing-panel').style.display = 'none';
         
         // Final skor panelini g√∂ster
         document.getElementById('final-score-panel').style.display = 'flex';
         
         // Kullanƒ±cƒ± adƒ±nƒ± al
         const username = currentUsername || 'Kullanƒ±cƒ±';
         
         // S√ºreyi hesapla
         const min = String(Math.floor(timeLeft / 60)).padStart(2, '0');
         const sec = String(timeLeft % 60).padStart(2, '0');
         const totalTime = `${min}:${sec}`;
         
         // Verileri doldur
         document.getElementById('final-username').textContent = username;
         document.getElementById('final-password-score').textContent = passwordScore + ' Puan';
         document.getElementById('final-share-score').textContent = shareScore + ' Puan';
         document.getElementById('final-phishing-score').textContent = phishingScore + ' Puan';
         document.getElementById('final-total-time').textContent = totalTime;
         document.getElementById('final-total-score').textContent = totalScore;
         
        // Skoru kaydet
        console.log("üíæ Skor kaydediliyor:", {
            username: username,
            totalScore: totalScore,
            totalTime: totalTime,
            isFirebaseEnabled: isFirebaseEnabled
        });
        saveScore(username, totalScore, totalTime);         // Timer'ƒ± durdur
         stopTimer();
     }

    // PAYLA≈û/SAKLA paneli - 10 Soru Sistemi
    let shareQuestions = [
        { text: 'Sƒ±nƒ±fƒ±n (√∂rneƒüin 5-A)', shareable: false, explanation: 'Hangi sƒ±nƒ±fta okuduƒüun ki≈üisel bir bilgidir. Tanƒ±madƒ±ƒüƒ±n ki≈üilerle payla≈ümamalƒ±sƒ±n!' },
        { text: 'En sevdiƒüin renk', shareable: true, explanation: 'Renk tercihin g√ºvenle payla≈üƒ±labilir ve arkada≈ü edinmek i√ßin g√ºzel bir konudur.' },
        { text: 'Okul numaranƒ±z', shareable: false, explanation: 'Okul numaran gibi √∂zel kimlik bilgilerini sadece √∂ƒüretmenin ve ailen bilmeli.' },
        { text: 'En sevdiƒüin √ßizgi film', shareable: true, explanation: '√áizgi film zevkin payla≈üƒ±labilir ve ortak ilgi alanƒ± olan arkada≈ülar bulabilirsin.' },
        { text: 'Hobin (√∂rneƒüin futbol)', shareable: true, explanation: 'Hobiler g√ºvenle payla≈üƒ±labilir ve yeni arkada≈ülƒ±klar kurman i√ßin harika konulardƒ±r.' },
        { text: 'Ev adresin', shareable: false, explanation: 'Ev adresin √ßok gizli bir bilgidir. Sadece ailen ve yakƒ±n akrabalar bilmeli.' },
        { text: 'En sevdiƒüin oyun', shareable: true, explanation: 'Oyun tercihlerin g√ºvenle payla≈üƒ±labilir ve oyun arkada≈ülarƒ± bulabilirsin.' },
        { text: 'Doƒüum tarihin', shareable: false, explanation: 'Doƒüum tarihin ki≈üisel bir bilgidir. K√∂t√º niyetli ki≈üiler bu bilgiyi k√∂t√ºye kullanabilir.' },
        { text: 'En sevdiƒüin hayvan', shareable: true, explanation: 'Hayvan sevgin g√ºvenle payla≈üƒ±labilir ve hayvansever arkada≈ülar edinebilirsin.' },
        { text: 'Telefon numaran', shareable: false, explanation: 'Telefon numaran √ßok √∂zel bir bilgidir. Sadece ailen ve √ßok yakƒ±n arkada≈ülarƒ±n bilmeli.' }
    ];

    let selectedAnswers = {};
    let shareQuestionsDisplayed = false;

    // Parola g√ºc√ºne g√∂re ses efektleri
    function playPasswordStrengthSound(strength) {
        // Mobil vibrasyon deseni
        const vibrationPatterns = {
            '√áok Zayƒ±f': [300, 150, 300, 150, 300, 150, 300], // Sƒ∞REN Tƒ∞TRE≈ûƒ∞Mƒ∞ - uzun alarm benzeri
            'Zayƒ±f': [100, 50, 100, 50, 100, 50, 100], // HIZLI ALARM Tƒ∞TRE≈ûƒ∞Mƒ∞
            'Orta': [100, 50, 100], // Hafif titre≈üim
            'ƒ∞yi': [40, 20, 40, 20, 60, 30, 40, 20, 80], // CIVILTILI Tƒ∞TRE≈ûƒ∞M - tweet benzeri ritim
            '√áok G√º√ßl√º': [30, 20, 30, 20, 30, 20, 30] // √áok hafif, ritmik
        };

        // Web Audio API ile ses √ºretimi
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // Parola g√ºc√ºne g√∂re ses parametreleri
            let duration, volume;
            
            switch(strength) {
                case '√áok Zayƒ±f':
                    // Sƒ∞REN ALARM - G√ºvenlik alarmƒ± benzeri
                    oscillator.type = 'sawtooth';
                    duration = 1.2;
                    volume = 0.18;
                    
                    // Ger√ßek siren efekti - yava≈ü yukarƒ± a≈üaƒüƒ±
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.3);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.6);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.9);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 1.2);
                    
                    // ƒ∞kinci oscilator ile daha g√º√ßl√º siren
                    const sirenOsc2 = audioContext.createOscillator();
                    const sirenGain2 = audioContext.createGain();
                    sirenOsc2.connect(sirenGain2);
                    sirenGain2.connect(audioContext.destination);
                    
                    sirenOsc2.type = 'square';
                    sirenOsc2.frequency.setValueAtTime(600, audioContext.currentTime);
                    sirenOsc2.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.3);
                    sirenOsc2.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.6);
                    sirenOsc2.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.9);
                    sirenOsc2.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 1.2);
                    
                    sirenGain2.gain.setValueAtTime(0.1, audioContext.currentTime);
                    sirenGain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
                    
                    sirenOsc2.start(audioContext.currentTime);
                    sirenOsc2.stop(audioContext.currentTime + 1.2);
                    break;
                    
                case 'Zayƒ±f':
                    // UYARI Sƒ∞RENƒ∞ - Kƒ±sa alarm benzeri
                    oscillator.type = 'square';
                    duration = 0.8;
                    volume = 0.15;
                    
                    // Hƒ±zlƒ± alarm efekti - wee-woo-wee-woo
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.3);
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.4);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.5);
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.6);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.7);
                    break;
                    
                case 'Orta':
                    // N√ñTR SES - D√º≈ü√ºk frekanslƒ±, yumu≈üak
                    oscillator.type = 'sine';
                    duration = 0.4;
                    volume = 0.08;
                    oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                    break;
                    
                case 'ƒ∞yi':
                    // CIVILTILI SES - Ku≈ü benzeri ne≈üeli melodi
                    oscillator.type = 'sine';
                    duration = 0.9;
                    volume = 0.12;
                    
                    // Tweet-tweet benzeri cƒ±vƒ±ltƒ± melodisi
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime); // ƒ∞lk tweet
                    oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(700, audioContext.currentTime + 0.2); // ƒ∞kinci tweet
                    oscillator.frequency.exponentialRampToValueAtTime(900, audioContext.currentTime + 0.3);
                    oscillator.frequency.setValueAtTime(650, audioContext.currentTime + 0.4); // √ú√ß√ºnc√º tweet
                    oscillator.frequency.exponentialRampToValueAtTime(850, audioContext.currentTime + 0.5);
                    oscillator.frequency.setValueAtTime(750, audioContext.currentTime + 0.6); // Final tweet
                    oscillator.frequency.exponentialRampToValueAtTime(950, audioContext.currentTime + 0.75);
                    
                    // ƒ∞kinci oscilator ile daha cƒ±vƒ±ltƒ±lƒ± efekt
                    const chirpOsc = audioContext.createOscillator();
                    const chirpGain = audioContext.createGain();
                    chirpOsc.connect(chirpGain);
                    chirpGain.connect(audioContext.destination);
                    
                    chirpOsc.type = 'triangle';
                    chirpOsc.frequency.setValueAtTime(1000, audioContext.currentTime + 0.15);
                    chirpOsc.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.25);
                    chirpOsc.frequency.setValueAtTime(1100, audioContext.currentTime + 0.35);
                    chirpOsc.frequency.exponentialRampToValueAtTime(1300, audioContext.currentTime + 0.45);
                    chirpOsc.frequency.setValueAtTime(1150, audioContext.currentTime + 0.55);
                    chirpOsc.frequency.exponentialRampToValueAtTime(1350, audioContext.currentTime + 0.7);
                    
                    chirpGain.gain.setValueAtTime(0.06, audioContext.currentTime + 0.1);
                    chirpGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
                    
                    chirpOsc.start(audioContext.currentTime + 0.1);
                    chirpOsc.stop(audioContext.currentTime + 0.8);
                    break;
                    
                case '√áok G√º√ßl√º':
                    // BA≈ûARI SESƒ∞ - Melodik, pozitif
                    oscillator.type = 'sine';
                    duration = 0.8;
                    volume = 0.12;
                    
                    // M√ºzikal akor etkisi
                    oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // C
                    oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.2); // E
                    oscillator.frequency.setValueAtTime(783, audioContext.currentTime + 0.4); // G
                    oscillator.frequency.setValueAtTime(1046, audioContext.currentTime + 0.6); // C y√ºksek
                    break;
                    
                default:
                    oscillator.type = 'sine';
                    duration = 0.3;
                    volume = 0.1;
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
            }

            gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);

        } catch (e) {
            console.log('Web Audio hatasƒ±:', e);
        }

        // Mobil titre≈üim
        if (navigator.vibrate && vibrationPatterns[strength]) {
            navigator.vibrate(vibrationPatterns[strength]);
        }

        // Konsol feedback
        const emojis = {
            '√áok Zayƒ±f': 'üö®üî¥',
            'Zayƒ±f': '‚ö†Ô∏èüü†',
            'Orta': 'üî∂üü°',
            'ƒ∞yi': 'üê¶üéµ',
            '√áok G√º√ßl√º': 'üéâüåü'
        };
        console.log(`${emojis[strength]} Parola G√ºc√º: ${strength} - SES √áALINDI!`);
    }

    // Phishing test i√ßin √∂zel ses efektleri
    function playPhishingSound(isCorrect) {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (isCorrect) {
                // DOƒûRU CEVAP - Net ba≈üarƒ± sesi (ding-ding!)
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                
                // ƒ∞ki telli ba≈üarƒ± sesi - DING DING!
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime); // Y√ºksek ding
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.1);
                oscillator.frequency.setValueAtTime(1200, audioContext.currentTime + 0.2); // Daha y√ºksek ding
                
                // Net fade out
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.12, audioContext.currentTime + 0.2);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.45);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.45);
                
                // ƒ∞kinci oscilator i√ßin echo efekti
                const oscillator2 = audioContext.createOscillator();
                const gainNode2 = audioContext.createGain();
                oscillator2.connect(gainNode2);
                gainNode2.connect(audioContext.destination);
                
                oscillator2.type = 'triangle';
                oscillator2.frequency.setValueAtTime(1000, audioContext.currentTime + 0.1);
                oscillator2.frequency.setValueAtTime(1400, audioContext.currentTime + 0.25);
                gainNode2.gain.setValueAtTime(0.08, audioContext.currentTime + 0.1);
                gainNode2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                
                oscillator2.start(audioContext.currentTime + 0.1);
                oscillator2.stop(audioContext.currentTime + 0.4);
                
                // Ba≈üarƒ± titre≈üimi
                if (navigator.vibrate) {
                    navigator.vibrate([30, 20, 50]);
                }
                
                console.log('‚úÖ Phishing: Doƒüru cevap!');
                
            } else {
                // YANLI≈û CEVAP - Buzzer, uyarƒ± sesi
                oscillator.type = 'square';
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                
                // Buzzer efekti - d√º≈ü√ºk frekanslƒ± alarm
                oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(100, audioContext.currentTime + 0.15);
                oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.3);
                
                // Keskin fade out
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
                
                // Uyarƒ± titre≈üimi
                if (navigator.vibrate) {
                    navigator.vibrate([150, 100, 150]);
                }
                
                console.log('‚ùå Phishing: Yanlƒ±≈ü cevap!');
            }

        } catch (e) {
            console.log('Phishing ses hatasƒ±:', e);
        }
    }

    // Final kutlama sesi - Parti m√ºziƒüi
    function playFinalVictorySound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            // KUTLAMA M√úZƒ∞ƒûƒ∞ - "Ta-ta-ta-TAAAA!" benzeri
            const celebrationNotes = [
                { freq: 784, time: 0.0, duration: 0.15, volume: 0.18 }, // G5 - Ta!
                { freq: 880, time: 0.2, duration: 0.15, volume: 0.18 }, // A5 - Ta!
                { freq: 988, time: 0.4, duration: 0.15, volume: 0.18 }, // B5 - Ta!
                { freq: 1175, time: 0.6, duration: 0.6, volume: 0.22 }, // D6 - TAAAA!
                
                // ƒ∞kinci dalga - daha y√ºksek
                { freq: 1175, time: 1.0, duration: 0.1, volume: 0.15 }, // D6
                { freq: 1319, time: 1.2, duration: 0.1, volume: 0.15 }, // E6
                { freq: 1568, time: 1.4, duration: 0.4, volume: 0.2 },  // G6 - FINAL!
            ];

            celebrationNotes.forEach((note) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(note.freq, audioContext.currentTime + note.time);
                
                // Daha keskin attack - kutlama hissi
                gainNode.gain.setValueAtTime(0, audioContext.currentTime + note.time);
                gainNode.gain.linearRampToValueAtTime(note.volume, audioContext.currentTime + note.time + 0.02);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + note.time + note.duration);
                
                oscillator.start(audioContext.currentTime + note.time);
                oscillator.stop(audioContext.currentTime + note.time + note.duration);
            });

            // KONFETI EFEKTƒ∞ - Rastgele y√ºksek frekanslƒ± sesler
            for (let i = 0; i < 8; i++) {
                const confettiOsc = audioContext.createOscillator();
                const confettiGain = audioContext.createGain();
                
                confettiOsc.connect(confettiGain);
                confettiGain.connect(audioContext.destination);
                
                confettiOsc.type = 'sine';
                const randomFreq = 1500 + Math.random() * 1000; // 1500-2500 Hz arasƒ±
                const randomTime = 0.8 + Math.random() * 0.8; // 0.8-1.6 saniye arasƒ±
                
                confettiOsc.frequency.setValueAtTime(randomFreq, audioContext.currentTime + randomTime);
                confettiGain.gain.setValueAtTime(0.03, audioContext.currentTime + randomTime);
                confettiGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + randomTime + 0.1);
                
                confettiOsc.start(audioContext.currentTime + randomTime);
                confettiOsc.stop(audioContext.currentTime + randomTime + 0.1);
            }

            // DAVUL BEAT - Kutlama ritmi
            const drumBeats = [0.0, 0.6, 1.0, 1.4];
            drumBeats.forEach((time) => {
                const drumOsc = audioContext.createOscillator();
                const drumGain = audioContext.createGain();
                
                drumOsc.connect(drumGain);
                drumGain.connect(audioContext.destination);
                
                drumOsc.type = 'square';
                drumOsc.frequency.setValueAtTime(80, audioContext.currentTime + time); // Bas davul
                
                drumGain.gain.setValueAtTime(0.12, audioContext.currentTime + time);
                drumGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + time + 0.1);
                
                drumOsc.start(audioContext.currentTime + time);
                drumOsc.stop(audioContext.currentTime + time + 0.1);
            });

            // KUTLAMA Tƒ∞TRE≈ûƒ∞Mƒ∞ - Parti benzeri
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 200, 100, 300, 100, 100, 50, 150]);
            }

            console.log('üéâüéä KUTLAMA! Siber g√ºvenlik kahramanƒ± oldun! üéäüéâ');

        } catch (e) {
            console.log('Kutlama ses hatasƒ±:', e);
        }
    }

    // Eski buzzer fonksiyonu (Share b√∂l√ºm√ºnde hala kullanƒ±lƒ±yor)
    function playBuzzerSound() {
        try {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            if (ctx.state === 'suspended') {
                ctx.resume();
            }
            
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            
            osc.connect(gain);
            gain.connect(ctx.destination);
            
            osc.frequency.value = 200;
            osc.type = 'square';
            gain.gain.value = 0.1;
            
            osc.start();
            osc.stop(ctx.currentTime + 0.3);
        } catch (e) {
            console.log('Web Audio hatasƒ±:', e);
        }
        
        if (navigator.vibrate) {
            navigator.vibrate([100, 50, 100]);
        }
        
        console.log('\x07');
    }
    
    // Ba≈üarƒ± sesi fonksiyonu (Share b√∂l√ºm√º doƒüru se√ßimler i√ßin) - GELƒ∞≈ûTƒ∞Rƒ∞LMƒ∞≈û
    function playSuccessSound() {
        try {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            
            // AudioContext'i aktifle≈ütir
            if (ctx.state === 'suspended') {
                ctx.resume().then(() => {
                    playSuccessSoundInternal(ctx);
                });
            } else {
                playSuccessSoundInternal(ctx);
            }
            
        } catch (e) {
            console.log('Ba≈üarƒ± sesi hatasƒ±:', e);
        }
        
        // Pozitif titre≈üim
        if (navigator.vibrate) {
            navigator.vibrate([30, 20, 50]);
        }
        
        console.log('‚úÖ Doƒüru se√ßim sesi √ßalƒ±nƒ±yor!');
    }
    
    function playSuccessSoundInternal(ctx) {
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        
        osc.connect(gain);
        gain.connect(ctx.destination);
        
        // Pozitif m√ºzikal ton - C major akor benzeri
        osc.frequency.setValueAtTime(523, ctx.currentTime); // C5
        osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1); // E5
        osc.frequency.setValueAtTime(783, ctx.currentTime + 0.2); // G5
        
        osc.type = 'sine';
        gain.gain.setValueAtTime(0.12, ctx.currentTime); // Ses seviyesi artƒ±rƒ±ldƒ±
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
        
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.4);
    }
    
    // Buton ses efektleri
    function playButtonClickSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // Standart buton sesi - kƒ±sa ve net
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.15);
            
            // Hafif titre≈üim
            if (navigator.vibrate) {
                navigator.vibrate([15]);
            }
            
        } catch (e) {
            console.log('Buton ses hatasƒ±:', e);
        }
    }
    
    function playStartGameSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            // Oyun ba≈ülama fanfarƒ± - kƒ±sa ve heyecanlƒ±
            const notes = [
                { freq: 523, time: 0.0, duration: 0.12 }, // C5
                { freq: 659, time: 0.12, duration: 0.12 }, // E5
                { freq: 783, time: 0.24, duration: 0.25 }, // G5 - uzun
            ];

            notes.forEach((note) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(note.freq, audioContext.currentTime + note.time);
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime + note.time);
                gainNode.gain.linearRampToValueAtTime(0.12, audioContext.currentTime + note.time + 0.02);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + note.time + note.duration);
                
                oscillator.start(audioContext.currentTime + note.time);
                oscillator.stop(audioContext.currentTime + note.time + note.duration);
            });
            
            // Ba≈ülama titre≈üimi
            if (navigator.vibrate) {
                navigator.vibrate([50, 30, 70]);
            }
            
            console.log('üéÆ Oyun ba≈ülama sesi √ßalƒ±ndƒ±!');
            
        } catch (e) {
            console.log('Oyun ba≈ülama ses hatasƒ±:', e);
        }
    }
    
    function playTransitionSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // Ge√ßi≈ü sesi - yumu≈üak y√ºkselme
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(700, audioContext.currentTime + 0.3);
            
            gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.4);
            
            // Ge√ßi≈ü titre≈üimi
            if (navigator.vibrate) {
                navigator.vibrate([30, 10, 40]);
            }
            
            console.log('‚û°Ô∏è Ge√ßi≈ü sesi √ßalƒ±ndƒ±!');
            
        } catch (e) {
            console.log('Ge√ßi≈ü ses hatasƒ±:', e);
        }
    }
    
    function playConfirmSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // Onay sesi - √ßift ton
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.setValueAtTime(0.08, audioContext.currentTime + 0.1);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.25);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.25);
            
            // Onay titre≈üimi
            if (navigator.vibrate) {
                navigator.vibrate([20, 10, 30]);
            }
            
            console.log('‚úÖ Onay sesi √ßalƒ±ndƒ±!');
            
        } catch (e) {
            console.log('Onay ses hatasƒ±:', e);
        }
    }
    
    function playCancelSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // ƒ∞ptal sesi - d√º≈ü√ºk ton
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.2);
            
            gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.25);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.25);
            
            // ƒ∞ptal titre≈üimi
            if (navigator.vibrate) {
                navigator.vibrate([40]);
            }
            
            console.log('‚ùå ƒ∞ptal sesi √ßalƒ±ndƒ±!');
            
        } catch (e) {
            console.log('ƒ∞ptal ses hatasƒ±:', e);
        }
    }
    
    // Yeni share panel fonksiyonlarƒ±
    function displayShareQuestions() {
        if (shareQuestionsDisplayed) return;
        
        const container = document.getElementById('share-questions-container');
        const resultsDiv = document.getElementById('share-results');
        
        // Temizle
        container.innerHTML = '';
        resultsDiv.style.display = 'none';
        resultsDiv.innerHTML = '';
        
        // Ya≈ü grubuna g√∂re sorularƒ± al
        const questionsForAge = getAgeSpecificShareQuestions();
        
        // √áocuklar i√ßin null d√∂nd√ºr√ºl√ºrse eski sistemi kullan
        if (questionsForAge === null || selectedAgeGroup === 'child') {
            // Eski sistem - genel payla≈ü/sakla sorularƒ± (√ßocuklar i√ßin)
            shareQuestions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'share-question-item';
                questionDiv.textContent = question.text;
                questionDiv.setAttribute('data-index', index);
                
                // Ba≈ülangƒ±√ßta t√ºm butonlarƒ± aktif hale getir
                questionDiv.style.pointerEvents = 'auto';
                questionDiv.style.opacity = '1';
                questionDiv.classList.remove('selected', 'correct', 'wrong');
                
                // Tablet i√ßin touchstart olayƒ± ekle
                questionDiv.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // Varsayƒ±lan dokunma davranƒ±≈üƒ±nƒ± engelle
                    const questionIndex = this.getAttribute('data-index');
                    toggleQuestionSelection(questionIndex, this);
                });
                
                questionDiv.addEventListener('click', function() {
                    const questionIndex = this.getAttribute('data-index');
                    toggleQuestionSelection(questionIndex, this);
                });
                
                container.appendChild(questionDiv);
            });
        } else {
            // Yeti≈ükinler i√ßin yeni sistem
            questionsForAge.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'share-question-item';
                questionDiv.textContent = question.question;
                questionDiv.setAttribute('data-index', index);
                questionDiv.setAttribute('data-correct', question.correct);
                
                // Ba≈ülangƒ±√ßta t√ºm butonlarƒ± aktif hale getir
                questionDiv.style.pointerEvents = 'auto';
                questionDiv.style.opacity = '1';
                questionDiv.classList.remove('selected', 'correct', 'wrong');
                
                // Tablet i√ßin touchstart olayƒ± ekle
                questionDiv.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // Varsayƒ±lan dokunma davranƒ±≈üƒ±nƒ± engelle
                    const questionIndex = this.getAttribute('data-index');
                    toggleQuestionSelection(questionIndex, this);
                });
                
                questionDiv.addEventListener('click', function() {
                    const questionIndex = this.getAttribute('data-index');
                    toggleQuestionSelection(questionIndex, this);
                });
                
                container.appendChild(questionDiv);
            });
        }
        
        // G√∂nderme butonunu g√∂ster ve stil ver
        const submitBtn = document.getElementById('continue-to-phishing-btn');
        if (submitBtn) {
            submitBtn.style.display = 'block !important';
            submitBtn.style.opacity = '1';
            submitBtn.style.visibility = 'visible';
            submitBtn.style.position = 'relative';
            submitBtn.style.zIndex = '100';
            submitBtn.style.width = '100%';
            submitBtn.style.textAlign = 'center';
            submitBtn.style.marginTop = '30px';
            submitBtn.style.padding = '20px';
        }
        shareQuestionsDisplayed = true;
    }
    
    function toggleQuestionSelection(index, element) {
        // Eƒüer bu soru zaten cevaplanmƒ±≈üsa, tekrar tƒ±klamaya izin verme
        if (selectedAnswers[index] !== undefined) {
            console.log("‚ö†Ô∏è Bu soru zaten cevaplanmƒ±≈ü, tekrar tƒ±klama yapƒ±lamaz!");
            return;
        }
        
        // Se√ßim yap (artƒ±k sadece bir kez yapƒ±labilir)
        selectedAnswers[index] = true;
        element.classList.add('selected');
        
        // Butonu devre dƒ±≈üƒ± bƒ±rak
        element.style.pointerEvents = 'none';
        element.style.opacity = '0.8';
        
        // Ya≈ü grubuna g√∂re soru sistemini belirle
        const questionsForAge = getAgeSpecificShareQuestions();
        let question, shouldBeSelected, explanation;
        
        if (questionsForAge === null || selectedAgeGroup === 'child') {
            // √áocuklar i√ßin eski sistem
            question = shareQuestions[index];
            shouldBeSelected = question.shareable === true;
            explanation = question.explanation;
        } else {
            // Yeti≈ükinler i√ßin yeni sistem
            question = questionsForAge[index];
            shouldBeSelected = question.correct === true;
            explanation = question.explanation;
        }
        
        if (shouldBeSelected) {
            // Doƒüru se√ßim - PUAN ARTTIR ve SES √áAL!
            element.classList.add('correct');
            shareScore += 30;
            addScore(30);
            
            // Geli≈ütirilmi≈ü ses √ßalma - browser kƒ±sƒ±tlamalarƒ±nƒ± a≈ü
            setTimeout(() => {
                playSuccessSound();
            }, 50);
            
            console.log("‚úÖ Doƒüru se√ßim: " + (question.text || question.question) + " (+30 puan)");
        } else {
            // Yanlƒ±≈ü se√ßim - PUAN D√ú≈û√úR, SES √áAL ve a√ßƒ±klama g√∂ster!
            element.classList.add('wrong');
            shareScore -= 15; // Yanlƒ±≈ü cevap i√ßin puan d√º≈ü√ºr
            addScore(-15);
            
            // Geli≈ütirilmi≈ü ses √ßalma - browser kƒ±sƒ±tlamalarƒ±nƒ± a≈ü
            setTimeout(() => {
                playBuzzerSound();
            }, 50);
            
            showExplanation(explanation, false);
            console.log("‚ùå Yanlƒ±≈ü se√ßim: " + (question.text || question.question) + " (-15 puan)");
        }
        
        // Submit butonunu al
        const submitBtn = document.getElementById('continue-to-phishing-btn');
        
        // Ya≈ü grubuna g√∂re soru sayƒ±sƒ±nƒ± belirle
        const totalQuestions = (questionsForAge === null || selectedAgeGroup === 'child') ? shareQuestions.length : questionsForAge.length;
        
        // T√ºm soruya cevap verildi mi kontrol et
        if (Object.keys(selectedAnswers).length === totalQuestions) {
            // T√ºm sorular cevaplandƒ± - buton kullanƒ±ma hazƒ±r (turuncu efekt yok)
            console.log("‚úÖ T√ºm sorular cevaplandƒ± - Phishing testine ge√ßebilirsiniz!");
        }
    }
    
    function showExplanation(text, isCorrect) {
        // Mevcut a√ßƒ±klamayƒ± kaldƒ±r
        const existingModal = document.getElementById('explanation-modal');
        if (existingModal) {
            existingModal.remove();
        }
        
        // Merkezi a√ßƒ±klama modalƒ± olu≈ütur
        const modalHTML = `
            <div id="explanation-modal" style="
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                background: rgba(0, 0, 0, 0.9);
                color: ${isCorrect ? '#00ff99' : '#ff4444'};
                border: 3px solid ${isCorrect ? '#00ff99' : '#ff4444'};
                border-radius: 12px;
                padding: 20px 30px;
                max-width: 500px;
                width: 90vw;
                text-align: center;
                font-size: 1.1rem;
                line-height: 1.5;
                box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
                animation: modalFadeIn 0.3s ease-out;
            ">
                <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">
                    ${isCorrect ? '‚úÖ DOƒûRU SE√áƒ∞M!' : '‚ùå YANLI≈û SE√áƒ∞M!'}
                </div>
                <div style="color: #ffffff; line-height: 1.4;">
                    ${text}
                </div>
                <div style="margin-top: 15px; font-size: 0.9rem; color: #aaa;">
                    Bu mesaj 5 saniye sonra kaybolacak...
                </div>
            </div>
        `;
        
        // Body'ye ekle
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        
        // 5 saniye sonra kaldƒ±r (√ßocuklarƒ±n okuyabileceƒüi s√ºre)
        setTimeout(() => {
            const modal = document.getElementById('explanation-modal');
            if (modal) {
                modal.style.animation = 'modalFadeOut 0.3s ease-in';
                setTimeout(() => modal.remove(), 300);
            }
        }, 5000);
    }
    
    function clearExplanation() {
        // Modal'ƒ± kaldƒ±r
        const modal = document.getElementById('explanation-modal');
        if (modal) {
            modal.remove();
        }
        
        // Share results div'ini de temizle
        const explanationDiv = document.getElementById('share-results');
        if (explanationDiv) {
            explanationDiv.style.display = 'none';
            explanationDiv.innerHTML = '';
        }
    }
    
    function showCompletionMessage() {
        // Mevcut modalƒ± kaldƒ±r
        clearExplanation();
        
        // √ñzel tamamlama modalƒ±
        const modalHTML = `
            <div id="explanation-modal" style="
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                background: linear-gradient(135deg, #1a472a, #0f2817);
                color: #00ff99;
                border: 3px solid #00ff99;
                border-radius: 15px;
                padding: 25px 35px;
                max-width: 550px;
                width: 90vw;
                text-align: center;
                font-size: 1.1rem;
                line-height: 1.5;
                box-shadow: 0 0 40px rgba(0, 255, 153, 0.3);
                animation: modalFadeIn 0.5s ease-out;
            ">
                <div style="font-size: 1.8rem; margin-bottom: 15px;">
                    üéâ TEBRƒ∞KLER! üéâ
                </div>
                <div style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; color: #fff;">
                    T√ºm 10 soruyu cevapladƒ±nƒ±z!
                </div>
                <div style="color: #ffffff; line-height: 1.4; margin-bottom: 15px;">
                    Phishing testine ge√ßmek i√ßin a≈üaƒüƒ±daki <strong>"Phishing Testine Ge√ß"</strong> butonuna tƒ±klayƒ±n.
                </div>
                <div style="font-size: 0.9rem; color: #aaa;">
                    Bu mesaj 0.9 saniye sonra kaybolacak...
                </div>
            </div>
        `;
        
        // Body'ye ekle
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        
        // 0.9 saniye sonra kaldƒ±r
        setTimeout(() => {
            const modal = document.getElementById('explanation-modal');
            if (modal) {
                modal.style.animation = 'modalFadeOut 0.3s ease-in';
                setTimeout(() => modal.remove(), 300);
            }
        }, 900);
    }
    
        function checkShareAnswers() {
        playButtonClickSound(); // Ses efekti ekle
        // Basit tamamlanma mesajƒ± g√∂ster
        showCompletionModal();
    }
    
    function showCompletionModal() {
        // Mevcut modallarƒ± kaldƒ±r
        clearExplanation();
        
        // Tamamlama modalƒ±
        const modalHTML = `
            <div id="explanation-modal" style="
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                max-width: 700px;
                width: 85vw;
                min-height: 400px;
                text-align: center;
                font-size: 1.3rem;
                line-height: 1.5;
                animation: modalFadeIn 0.5s ease-out;
            ">
                <img src="assets/Asset 43.svg" alt="Modal √áer√ßeve" style="
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: 0;
                    pointer-events: none;
                ">
                <div style="
                    position: relative;
                    z-index: 1;
                    padding: 50px 40px;
                    color: #ffffff;
                ">
                <div style="margin-bottom: 30px;">
                    <img src="assets/Asset 46.svg" alt="Soru ƒ∞≈üareti" style="max-width: 60px; height: auto;">
                </div>
                <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; color: #fff;">
                    B√∂l√ºm√º bitirmek istediƒüinize emin misiniz?
                </div>
                <div style="color: #ffffff; line-height: 1.4; margin-bottom: 30px; font-size: 1.2rem;">
                    Bu i≈ülemden sonra oltalama testine ge√ßeceksiniz.
                </div>
                <div style="margin-top: 35px; display: flex; gap: 30px; justify-content: center; align-items: center; flex-wrap: wrap;">
                    <img src="assets/Asset 60.svg" alt="Ge√ß" onclick="continueToPhishing()" style="
                        max-width: 180px;
                        cursor: pointer;
                        transition: transform 0.2s ease;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    
                    <img src="assets/Asset 61.svg" alt="Ge√ßme" onclick="cancelToPhishing()" style="
                        max-width: 180px;
                        cursor: pointer;
                        transition: transform 0.2s ease;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                </div>
                </div>
            </div>
        `;
        
        // Body'ye ekle
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }
    
    function continueToPhishing() {
        playConfirmSound(); // Onay ses efekti
        // Modal'ƒ± kaldƒ±r
        clearExplanation();
        
        // Phishing testine ge√ß
        showPhishingPanel();
    }
    
    function cancelToPhishing() {
        playCancelSound(); // ƒ∞ptal ses efekti
        // Modal'ƒ± kaldƒ±r
        clearExplanation();
        
        // Payla≈ü/sakla b√∂l√ºm√ºnde kal - hi√ßbir ≈üey yapma, modal sadece kapansƒ±n
        console.log("üë§ Kullanƒ±cƒ± phishing testine ge√ßmek istemedi, payla≈ü/sakla b√∂l√ºm√ºnde kalƒ±yor");
    }
    
    // Ana Ekrana D√∂n Butonu Event Listener
    document.getElementById('home-button').addEventListener('click', function() {
        playButtonClickSound(); // Ses efekti ekle
        showHomeConfirmModal();
    });
    
    // Ana ekrana d√∂n onay modalƒ±
    function showHomeConfirmModal() {
        // Mevcut modallarƒ± kaldƒ±r
        clearExplanation();
        
        // Ana ekrana d√∂n modalƒ±
        const modalHTML = `
            <div id="explanation-modal" style="
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                max-width: 700px;
                width: 85vw;
                min-height: 400px;
                text-align: center;
                font-size: 1.3rem;
                line-height: 1.5;
                animation: modalFadeIn 0.5s ease-out;
            ">
                <img src="assets/Asset 43.svg" alt="Modal √áer√ßeve" style="
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: 0;
                    pointer-events: none;
                ">
                <div style="
                    position: relative;
                    z-index: 1;
                    padding: 50px 40px;
                    color: #ffffff;
                ">
                <div style="margin-bottom: 30px;">
                    <img src="assets/Asset 46.svg" alt="Soru ƒ∞≈üareti" style="max-width: 60px; height: auto;">
                </div>
                <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; color: #fff;">
                    Ana ekrana d√∂nmek istediƒüinize emin misiniz?
                </div>
                <div style="color: #ffffff; line-height: 1.4; margin-bottom: 30px; font-size: 1.2rem;">
                    T√ºm ilerlemeniz kaybolacak ve oyun ba≈üa d√∂necektir.
                </div>
                <div style="margin-top: 35px; display: flex; gap: 30px; justify-content: center; align-items: center; flex-wrap: wrap;">
                    <img src="assets/Asset 60.svg" alt="D√∂n" onclick="confirmGoHome()" style="
                        max-width: 180px;
                        cursor: pointer;
                        transition: transform 0.2s ease;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    
                    <img src="assets/Asset 61.svg" alt="Kalma" onclick="cancelGoHome()" style="
                        max-width: 180px;
                        cursor: pointer;
                        transition: transform 0.2s ease;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                </div>
                </div>
            </div>
        `;
        
        // Body'ye ekle
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }
    
    // Ana ekrana d√∂n onaylandƒ±
    function confirmGoHome() {
        playConfirmSound(); // Onay ses efekti
        // Modal'ƒ± kaldƒ±r
        clearExplanation();
        
        // Oyunu tamamen sƒ±fƒ±rla ve ana ekrana d√∂n
        resetGameToHome();
    }
    
    // Ana ekrana d√∂n iptal edildi
    function cancelGoHome() {
        playCancelSound(); // ƒ∞ptal ses efekti
        // Modal'ƒ± kaldƒ±r
        clearExplanation();
        
        // Mevcut panelde kal
        console.log("üë§ Kullanƒ±cƒ± ana ekrana d√∂nmek istemedi, mevcut panelde kalƒ±yor");
    }
    
    // Oyunu tamamen sƒ±fƒ±rla ve ana ekrana d√∂n
    function resetGameToHome() {
        // Ana ekrana d√∂n butonunu gizle
        document.getElementById('home-button').style.display = 'none';
        
        // T√ºm panelleri gizle
        document.getElementById('age-selection-panel').style.display = 'none';
        document.getElementById('main-panel').style.display = 'none';
        document.getElementById('username-panel').style.display = 'none';
        document.getElementById('password-panel').style.display = 'none';
        document.getElementById('share-panel').style.display = 'none';
        document.getElementById('phishing-panel').style.display = 'none';
        document.getElementById('final-score-panel').style.display = 'none';
        document.getElementById('scoreboard-panel').style.display = 'none';
        
        // Ya≈ü grubu se√ßimini sƒ±fƒ±rla
        selectedAgeGroup = null;
        
        // Ya≈ü se√ßim panelini g√∂ster (her seferinde sorsun)
        document.getElementById('age-selection-panel').style.display = 'block';
        console.log("üîÑ Ana ekrana d√∂n√ºld√º - ya≈ü se√ßimi yeniden g√∂steriliyor");
        
        // Kullanƒ±cƒ± adƒ± input'unu temizle
        const usernameInput = document.getElementById('username-input');
        if (usernameInput) {
            usernameInput.value = '';
        }
        
        // Oyunu tamamen sƒ±fƒ±rla
        totalScore = 0;
        passwordScore = 0;
        shareScore = 0;
        phishingScore = 0;
        timeLeft = 0;
        timerStarted = false;
        currentPhishingQuestion = 0;
        currentUsername = '';
        
        // Timer'ƒ± durdur
        if (timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
        }
        
        // Parola panelini sƒ±fƒ±rla
        const passwordInput = document.getElementById('password-input-1');
        const confirmPasswordInput = document.getElementById('password-input-2');
        if (passwordInput) passwordInput.value = '';
        if (confirmPasswordInput) confirmPasswordInput.value = '';
        
        // Parola a√ßƒ±klamasƒ±nƒ± sƒ±fƒ±rla
        const passwordDescElement = document.getElementById('password-desc');
        if (passwordDescElement) {
            passwordDescElement.textContent = 'Parolanƒ±zƒ± girin ve g√ºc√ºn√º test edin.';
            passwordDescElement.style.color = ''; // Varsayƒ±lan renk
        }
        if (confirmPasswordInput) confirmPasswordInput.value = '';
        
        // Parola kontrol butonunu sƒ±fƒ±rla
        const checkBtn = document.getElementById('check-password-btn');
        const checkBtnWrapper = document.getElementById('password-check-btn-wrapper');
        if (checkBtn) {
            checkBtn.style.opacity = '0.5';
            checkBtn.style.pointerEvents = 'none';
            checkBtn.style.display = 'block';
        }
        if (checkBtnWrapper) {
            checkBtnWrapper.style.display = 'flex';
        }
        
        // Parola match mesajƒ±nƒ± temizle
        const matchMessage = document.getElementById('password-match-message');
        if (matchMessage) {
            matchMessage.textContent = '';
        }
        
        // Input wrapper'larƒ± g√∂ster
        const passwordWrapper = document.getElementById('password-input-wrapper');
        const confirmWrapper = document.getElementById('password-confirm-wrapper');
        if (passwordWrapper) passwordWrapper.style.display = 'flex';
        if (confirmWrapper) confirmWrapper.style.display = 'flex';
        
        // A√ßƒ±klamayƒ± sƒ±fƒ±rla
        const passwordDesc = document.getElementById('password-desc');
        if (passwordDesc) {
            passwordDesc.textContent = 'Parolanƒ±zƒ± girin ve g√ºc√ºn√º test edin.';
            passwordDesc.style.display = 'block';
        }
        
        // Parola g√º√ß sonu√ßlarƒ±nƒ± temizle
        const passwordResult = document.querySelector('.password-result');
        if (passwordResult) passwordResult.style.display = 'none';
        
        const nextTaskBtn = document.getElementById('next-task-btn');
        if (nextTaskBtn) nextTaskBtn.style.display = 'none';
        
        // Share panel'ƒ± sƒ±fƒ±rla
        selectedAnswers = {};
        shareQuestionsDisplayed = false;
        
        // Share panel √∂ƒüelerini temizle
        const shareContainer = document.getElementById('share-questions-container');
        const shareResults = document.getElementById('share-results');
        const shareSubmitBtn = document.getElementById('continue-to-phishing-btn');
        
        if (shareContainer) shareContainer.innerHTML = '';
        if (shareResults) {
            shareResults.style.display = 'none';
            shareResults.innerHTML = '';
        }
        if (shareSubmitBtn) shareSubmitBtn.style.display = 'block';
        
        // Share panel a√ßƒ±klamasƒ±nƒ± sƒ±fƒ±rla
        const shareDesc = document.querySelector('#share-panel .password-desc');
        if (shareDesc) {
            shareDesc.textContent = 'A≈üaƒüƒ±daki bilgilerden hangilerini g√ºvenle payla≈üabileceƒüini se√ß:';
        }
        
        // Phishing panel'ƒ± sƒ±fƒ±rla
        currentPhishingQuestion = 0;
        
        // Phishing panel a√ßƒ±klamasƒ±nƒ± temizle
        const phishingExplanation = document.getElementById('phishing-explanation');
        if (phishingExplanation) {
            phishingExplanation.textContent = '';
            phishingExplanation.className = 'share-explanation';
        }
        
        // Phishing butonlarƒ±nƒ± sƒ±fƒ±rla
        const phishingButtons = document.querySelectorAll('.phishing-button');
        phishingButtons.forEach(btn => {
            btn.style.pointerEvents = 'auto';
            btn.style.opacity = '1';
            btn.style.transform = 'scale(1)';
        });
        
        // Skor ve timer'ƒ± sƒ±fƒ±rla
        setScore(0);
        updateTimer();
        
        // Skor tablosunu g√ºncelle
        const scoreElements = ['score', 'score-share', 'score-phishing'];
        scoreElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = '0';
            }
        });
        
        console.log("üè† Oyun ana ekrana d√∂nd√ºr√ºld√º ve tamamen sƒ±fƒ±rlandƒ±");
    }
    
    // Phishing test acil durumu - eƒüer test tamamen √ß√∂kerse kullan
    window.emergencySkipPhishing = function() {
        console.log("üö® Acil durum: Phishing test atlanƒ±yor");
        
        // Puanlarƒ± sƒ±fƒ±rla
        phishingScore = 0;
        
        // Final skora ge√ß
        setTimeout(() => {
            showFinalScorePanel();
        }, 800);
    };
    
    // Phishing test debug fonksiyonu
    window.debugPhishingTest = function() {
        console.log("üîç Phishing Test Hata Ayƒ±klama Bilgileri:");
        console.log("- Mevcut Soru:", currentPhishingQuestion);
        console.log("- Toplam Soru:", phishingQuestions.length);
        console.log("- Phishing Puanƒ±:", phishingScore);
        
        const desc = document.getElementById('phishing-desc');
        const buttons = document.querySelectorAll('.phishing-button');
        const explanation = document.getElementById('phishing-explanation');
        const panel = document.getElementById('phishing-panel');
        
        console.log("- A√ßƒ±klama √ñƒüesi:", desc ? "‚úÖ Bulundu" : "‚ùå Eksik");
        console.log("- Buton Sayƒ±sƒ±:", buttons.length);
        console.log("- A√ßƒ±klama √ñƒüesi:", explanation ? "‚úÖ Bulundu" : "‚ùå Eksik");
        console.log("- Panel G√∂r√ºn√ºr:", panel && panel.style.display !== 'none' ? "‚úÖ G√∂r√ºn√ºr" : "‚ùå Gizli");
        
        buttons.forEach((btn, index) => {
            const textDiv = btn.querySelector('div');
            console.log(`- Buton ${index + 1}:`, {
                hasText: textDiv ? "‚úÖ Metin div'i var" : "‚ùå Metin div'i yok",
                text: textDiv ? textDiv.textContent : "Yok",
                answer: btn.getAttribute('data-answer')
            });
        });
        
        if (buttons.length === 0) {
            console.log("üö® Hi√ß buton bulunamadƒ±! emergencySkipPhishing() √ßalƒ±≈ütƒ±rƒ±n.");
        }
    };
    

    
    // Y√ºkleme ekranƒ±nƒ± gizle
    // Oyun y√ºkleniyor m√ºziƒüi
    function playLoadingMusic() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            // Siber/elektronik temalƒ± melodi notalarƒ±
            const melody = [
                { freq: 261.63, time: 0.0, duration: 0.3 }, // C4
                { freq: 329.63, time: 0.3, duration: 0.3 }, // E4
                { freq: 392.00, time: 0.6, duration: 0.3 }, // G4
                { freq: 523.25, time: 0.9, duration: 0.4 }, // C5
                { freq: 659.25, time: 1.3, duration: 0.3 }, // E5
                { freq: 783.99, time: 1.6, duration: 0.3 }, // G5
                { freq: 1046.50, time: 1.9, duration: 0.5 }, // C6
                
                // ƒ∞kinci dalga - daha dramatik
                { freq: 392.00, time: 2.5, duration: 0.2 }, // G4
                { freq: 440.00, time: 2.7, duration: 0.2 }, // A4
                { freq: 493.88, time: 2.9, duration: 0.2 }, // B4
                { freq: 523.25, time: 3.1, duration: 0.4 }, // C5
                { freq: 659.25, time: 3.5, duration: 0.6 }, // E5 - uzun
            ];

            // Ana melodi
            melody.forEach((note, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Siber tema i√ßin triangle wave
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(note.freq, audioContext.currentTime + note.time);
                
                // Fade in-out efekti
                gainNode.gain.setValueAtTime(0, audioContext.currentTime + note.time);
                gainNode.gain.linearRampToValueAtTime(0.08, audioContext.currentTime + note.time + 0.05);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + note.time + note.duration);
                
                oscillator.start(audioContext.currentTime + note.time);
                oscillator.stop(audioContext.currentTime + note.time + note.duration);
            });

            // Alt bas notalarƒ± - derinlik katmak i√ßin
            const bassNotes = [
                { freq: 65.41, time: 0.0, duration: 1.0 }, // C2
                { freq: 87.31, time: 1.0, duration: 1.0 }, // F2
                { freq: 98.00, time: 2.0, duration: 1.0 }, // G2
                { freq: 130.81, time: 3.0, duration: 1.2 }, // C3
            ];

            bassNotes.forEach((note) => {
                const bassOsc = audioContext.createOscillator();
                const bassGain = audioContext.createGain();
                
                bassOsc.connect(bassGain);
                bassGain.connect(audioContext.destination);
                
                bassOsc.type = 'sine';
                bassOsc.frequency.setValueAtTime(note.freq, audioContext.currentTime + note.time);
                
                bassGain.gain.setValueAtTime(0.06, audioContext.currentTime + note.time);
                bassGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + note.time + note.duration);
                
                bassOsc.start(audioContext.currentTime + note.time);
                bassOsc.stop(audioContext.currentTime + note.time + note.duration);
            });

            // Elektronik efektler - siber tema
            for (let i = 0; i < 6; i++) {
                const effectOsc = audioContext.createOscillator();
                const effectGain = audioContext.createGain();
                
                effectOsc.connect(effectGain);
                effectGain.connect(audioContext.destination);
                
                effectOsc.type = 'square';
                const randomFreq = 800 + Math.random() * 400; // 800-1200 Hz
                const randomTime = Math.random() * 3.5; // 0-3.5 saniye arasƒ±
                
                effectOsc.frequency.setValueAtTime(randomFreq, audioContext.currentTime + randomTime);
                effectGain.gain.setValueAtTime(0.02, audioContext.currentTime + randomTime);
                effectGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + randomTime + 0.1);
                
                effectOsc.start(audioContext.currentTime + randomTime);
                effectOsc.stop(audioContext.currentTime + randomTime + 0.1);
            }

            console.log('üéµ Oyun y√ºkleniyor m√ºziƒüi ba≈ülatƒ±ldƒ±!');

        } catch (e) {
            console.log('Loading m√ºzik hatasƒ±:', e);
        }
    }

    window.addEventListener('load', function() {
        // M√ºziƒüi ba≈ülat
        playLoadingMusic();
        
        setTimeout(function() {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                loadingScreen.style.opacity = '0';
                loadingScreen.style.transition = 'opacity 0.5s ease-out';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }
        }, 800); // 0.8 saniye bekle
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        console.log("üöÄ Sayfa y√ºklendi, ya≈ü grubu kontrol√º ba≈ülƒ±yor...");
        
        // √ñnce t√ºm panelleri gizle
        document.getElementById('age-selection-panel').style.display = 'none';
        document.getElementById('main-panel').style.display = 'none';
        document.getElementById('username-panel').style.display = 'none';
        document.getElementById('password-panel').style.display = 'none';
        document.getElementById('share-panel').style.display = 'none';
        document.getElementById('phishing-panel').style.display = 'none';
        document.getElementById('final-score-panel').style.display = 'none';
        document.getElementById('scoreboard-panel').style.display = 'none';
        
        // Debug: localStorage temizleme i√ßin
        if (window.location.hash === '#clear') {
            localStorage.removeItem('selectedAgeGroup');
            console.log("üóëÔ∏è LocalStorage temizlendi - sayfa yenile");
        }
        
        // Her seferinde ya≈ü se√ßimi sor - localStorage kontrol√º yok
        console.log("üë∂/üë® Her seferinde ya≈ü grubu se√ßimi isteniyor");
        document.getElementById('age-selection-panel').style.display = 'block';
        
        var btnYes = document.getElementById('btn-share-yes');
        var btnNo = document.getElementById('btn-share-no');
        var explanation = document.getElementById('share-explanation');
        
        // Skor tablosu butonlarƒ±
        const scoreboardBtn = document.querySelector('.scoreboard-img').parentElement;
        if (scoreboardBtn) {
            scoreboardBtn.onclick = function() {
                // Yeni pencerede skor tablosunu a√ß
                openScoreboardWindow();
            };
        }
        
        // Yeni pencerede skor tablosu a√ßma fonksiyonu
        function openScoreboardWindow() {
            const screenWidth = window.screen.width;
            const screenHeight = window.screen.height;
            const windowWidth = Math.min(1400, screenWidth * 0.9);
            const windowHeight = Math.min(900, screenHeight * 0.9);
            const left = (screenWidth - windowWidth) / 2;
            const top = (screenHeight - windowHeight) / 2;
            
            const scoreboardWindow = window.open(
                'scoreboard.html',
                'scoreboardWindow',
                `width=${windowWidth},height=${windowHeight},left=${left},top=${top},resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,status=no`
            );
            
            if (scoreboardWindow) {
                scoreboardWindow.focus();
            } else {
                // Popup engellenirse fallback olarak aynƒ± pencerede a√ß
                alert('Popup engellendi! Skor tablosunu aynƒ± pencerede a√ßƒ±yorum.');
                // T√ºm panelleri gizle
                document.getElementById('main-panel').style.display = 'none';
                document.getElementById('username-panel').style.display = 'none';
                document.getElementById('password-panel').style.display = 'none';
                document.getElementById('share-panel').style.display = 'none';
                document.getElementById('phishing-panel').style.display = 'none';
                document.getElementById('final-score-panel').style.display = 'none';
                
                // Skor tablosu panelini g√∂ster
                document.getElementById('scoreboard-panel').style.display = 'flex';
                displayScoreboard();
            }
        }
        
        // Skor tablosu yenile butonu
        const refreshBtn = document.getElementById('refresh-scoreboard-btn');
        if (refreshBtn) {
            refreshBtn.onclick = function() {
                currentPage = 1; // ƒ∞lk sayfaya d√∂n
                displayScoreboard();
            };
        }
        
        // Skor tablosu ana men√º butonu
        const scoreboardBackBtn = document.getElementById('scoreboard-back-btn');
        if (scoreboardBackBtn) {
            scoreboardBackBtn.onclick = function() {
                currentPage = 1; // Sayfa sƒ±fƒ±rla
                document.getElementById('scoreboard-panel').style.display = 'none';
                document.getElementById('main-panel').style.display = 'flex';
            };
        }
        
        // Sayfalama butonlarƒ± event listeners
        const prevPageBtn = document.getElementById('prev-page-btn');
        const nextPageBtn = document.getElementById('next-page-btn');
        
        // Eski event listener'larƒ± temizle
        if (prevPageBtn) {
            prevPageBtn.onclick = null;
            prevPageBtn.addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    console.log('üîô √ñnceki sayfaya ge√ßiliyor:', currentPage);
                    displayCurrentPage();
                    updatePaginationControls(allScores.length);
                }
            });
        }
        
        if (nextPageBtn) {
            nextPageBtn.onclick = null;
            nextPageBtn.addEventListener('click', function() {
                const totalPages = Math.ceil(allScores.length / scoresPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    console.log('‚û°Ô∏è Sonraki sayfaya ge√ßiliyor:', currentPage);
                    displayCurrentPage();
                    updatePaginationControls(allScores.length);
                }
            });
        }
        
        // Firebase ger√ßek zamanlƒ± skorboard sistemini ba≈ülat
        setTimeout(() => {
            setupGameRealtimeScoreboard();
        }, 800);
        
                 // Yeni share panel event listeners
         const submitAnswersBtn = document.getElementById('continue-to-phishing-btn');
         if (submitAnswersBtn) {
             submitAnswersBtn.onclick = function() {
                 // Her durumda sonu√ß ekranƒ±nƒ± g√∂ster
                 checkShareAnswers();
             };
         }
        
                 // Share panel fonksiyonu - phishing'ten geri d√∂n√º≈ü i√ßin
         window.showSharePanel = function() {
             document.getElementById('password-panel').style.display = 'none';
             document.getElementById('phishing-panel').style.display = 'none';
             document.getElementById('share-panel').style.display = 'flex';
             displayShareQuestions();
         };
         
         // Phishing panel fonksiyonu
         window.showPhishingPanel = function() {
             console.log("üéÆ Phishing paneline ge√ßiliyor...");
             
             document.getElementById('share-panel').style.display = 'none';
             document.getElementById('phishing-panel').style.display = 'flex';
             
             // ƒ∞lk phishing sorusunu ba≈ülat
             currentPhishingQuestion = 0;
             
             // 5 saniye timeout - eƒüer phishing test 5 saniyede y√ºklenmezse atla
             const timeoutId = setTimeout(() => {
                 console.log("‚è∞ Phishing test y√ºkleme timeout - otomatik atlama");
                 const desc = document.getElementById('phishing-desc');
                 if (desc) {
                     desc.innerHTML = 'Teknik sorun nedeniyle test atlanƒ±yor...<br>Final skora ge√ßiliyor.';
                 }
                 setTimeout(() => {
                     emergencySkipPhishing();
                 }, 800);
             }, 5000);
             
             // Global olarak sakla (ba≈üarƒ±lƒ± y√ºklendiƒüinde iptal etmek i√ßin)
             window.phishingTimeoutId = timeoutId;
             
             // DOM'un tam y√ºklenmesini bekle
             setTimeout(() => {
                 console.log("üöÄ Phishing test ba≈ülatƒ±lƒ±yor...");
                 initializePhishingTest();
             }, 100);
         };
         
         // Phishing test ba≈ülatma fonksiyonu
         function initializePhishingTest() {
             console.log("üîß Phishing test initialize ediliyor...");
             
             // Phishing panel'ƒ±nƒ±n g√∂r√ºn√ºr olduƒüunu kontrol et
             const phishingPanel = document.getElementById('phishing-panel');
             if (!phishingPanel || phishingPanel.style.display === 'none') {
                 console.error("‚ùå Phishing panel g√∂r√ºn√ºr deƒüil!");
                 return;
             }
             
             // Ya≈ü grubuna g√∂re phishing sorularƒ±nƒ± y√ºkle
             phishingQuestions = getAgeSpecificPhishingQuestions();
             console.log("üìö Ya≈ü grubu i√ßin phishing sorularƒ± y√ºklendi:", selectedAgeGroup, phishingQuestions.length);
             
             // T√ºm phishing butonlarƒ±nƒ±n mevcut olduƒüunu kontrol et
             const buttons = document.querySelectorAll('.phishing-button');
             if (buttons.length === 0) {
                 console.error("‚ùå Phishing butonlarƒ± bulunamadƒ±!");
                 return;
             }
             
             // Butonlarƒ± temizle ve hazƒ±rla
             buttons.forEach((button, index) => {
                 button.style.display = 'block';
                 button.style.pointerEvents = 'auto';
                 button.style.opacity = '1';
                 button.style.transform = 'scale(1)';
                 
                 // Div yoksa olu≈ütur
                 let textDiv = button.querySelector('div');
                 if (!textDiv) {
                     textDiv = document.createElement('div');
                     textDiv.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: "Gilmer Light", sans-serif; font-size: 1rem; text-align: center; width: 90%; line-height: 1.2;';
                     button.appendChild(textDiv);
                 }
             });
             
             console.log(`‚úÖ ${buttons.length} phishing butonu hazƒ±rlandƒ±`);
             
             // ƒ∞lk soruyu g√∂ster
             currentPhishingQuestion = 0;
             showNextPhishingQuestion();
         };

        // Safari PWA ve kiosk mode optimizasyonlarƒ±
        function initializeSafariPWA() {
            // Safari standalone mode kontrol√º
            if (('standalone' in window.navigator) && window.navigator.standalone) {
                console.log('‚úÖ Safari PWA standalone modda √ßalƒ±≈üƒ±yor');
                document.body.classList.add('safari-standalone');
            }

            // iOS Safari viewport height d√ºzeltmesi
            function setViewportHeight() {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                
                // Body ve background'ƒ± tamamen doldur
                document.body.style.height = '100vh';
                document.body.style.height = `${window.innerHeight}px`;
                
                const background = document.querySelector('.background');
                if (background) {
                    background.style.height = '100vh';
                    background.style.height = `${window.innerHeight}px`;
                }
            }

            setViewportHeight();
            window.addEventListener('resize', setViewportHeight);
            window.addEventListener('orientationchange', () => {
                setTimeout(setViewportHeight, 100);
            });

            // Status bar gizleme (iOS Safari) - Beyaz alanlarƒ± tamamen kaldƒ±r
            if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
                const metaViewport = document.querySelector('meta[name="viewport"]');
                if (metaViewport) {
                    metaViewport.setAttribute('content', 
                        'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no');
                }
                
                // Body'yi tamamen siyah yap
                document.body.style.backgroundColor = '#0a1428';
                document.documentElement.style.backgroundColor = '#0a1428';
            }

            // Tam ekran desteƒüi
            function requestFullscreen() {
                const element = document.documentElement;
                if (element.requestFullscreen) {
                    element.requestFullscreen();
                } else if (element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if (element.mozRequestFullScreen) {
                    element.mozRequestFullScreen();
                } else if (element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                }
            }

            // Safari PWA i√ßin gesture desteƒüi
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault(); // √áok parmaklƒ± gesture'larƒ± engelle
                }
            }, {passive: false});

            // Zoom engelleme
            document.addEventListener('gesturestart', function(e) {
                e.preventDefault();
            });

            console.log('üçé Safari PWA optimizasyonlarƒ± aktive edildi');
        }

        // Sayfa y√ºklendiƒüinde Safari PWA ayarlarƒ±nƒ± ba≈ülat
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSafariPWA);
        } else {
            initializeSafariPWA();
        }
        
        // Service Worker kaydƒ± - offline √ßalƒ±≈üma i√ßin
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('./sw.js');
                    console.log('‚úÖ Service Worker kaydedildi:', registration.scope);
                    
                    // Yeni version varsa otomatik g√ºncelle
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('üîÑ Yeni Service Worker hazƒ±r, sayfa yenileniyor...');
                                window.location.reload();
                            }
                        });
                    });
                } catch (error) {
                    console.warn('‚ö†Ô∏è Service Worker kaydedilemedi:', error);
                }
            });
        }
    });
    </script>
</body>
</html> 
